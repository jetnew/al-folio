---
layout: post
title: "Living Article"
description: Living Article testing.
date: 3023-1-1
tags: tutorial
giscus_comments: true
---
<style>
article{--section-prefix:"§";--equation-prefix:"Equation ";--figure-prefix:"Figure ";--table-prefix:"Table ";--cite-list-start:"[";--cite-list-end:"]";--double-quote-start:"“";--double-quote-end:"”";--single-quote-start:"‘";--single-quote-end:"’";--highlight-color:#ff0;--tiny-size:0.5em;--script-size:0.7em;--smaller-size:0.8em;--small-size:0.9em;--large-size:1.2em;--larger-size:1.4em;--huge-size:1.8em;--inline-math-size:1em;--ref-color:steelblue;--ref-color-light:#c8dae9;--ref-color-hover:#90b4d2;--ref-color-error:maroon;--ref-weight:500;--ref-decoration:none;width:var(--article-width);margin-left:var(--article-margin-left);padding:var(--article-padding);--inline-math-size:1.14em}a{color:var(--ref-color);font-weight:var(--ref-weight);text-decoration:var(--ref-decoration)}a:hover{color:var(--ref-color-hover)}sub,sup{line-height:0}q{quotes:var(--double-quote-start) var(--double-quote-end)}q.single{quotes:var(--single-quote-start) var(--single-quote-end)}blockquote{margin-left:2em}.action{cursor:pointer;text-decoration:underline dashed 1px #444}header h1{font-size:var(--huge-size)}header .author-org{font-style:italic}header .author-org::before{content:" · "}h1{font-size:1.4rem}h2{font-size:1.2rem}h3{font-size:1.1rem}h4,h5,h6{font-size:1rem}h1[data-counter]::before,h2[data-counter]::before,h3[data-counter]::before{content:attr(data-counter) " "}figure.figure>figcaption[data-counter]::before,figure.teaser>figcaption[data-counter]::before{content:var(--figure-prefix) attr(data-counter) ". "}figure.table>figcaption[data-counter]::before{content:var(--table-prefix) attr(data-counter) ". "}table{border-spacing:0;border-collapse:collapse}thead tr{border-bottom:1px solid #ccc}tbody td,thead th{font-size:var(--small-size);padding:1px .33em;text-align:left;font-variant-numeric:tabular-nums}tbody tr{border-bottom:1px solid #eee}ol.references{padding-inline-start:2em}ol.references li{font-size:var(--small-size);margin-bottom:6px}:root{--max-article-width:100ex;--article-padding:32px;--margin-width:400px;--gap-width:100px;--article-width:min(var(--max-article-width), calc(100vw - var(--article-padding) * 2 - var(--gap-width) - var(--margin-width)));--article-margin-left:max(0px, calc(((100vw - var(--article-width) - var(--gap-width) - var(--margin-width)) / 2)))}html{box-sizing:border-box}*,:after,:before{box-sizing:inherit;margin:0;padding:0}h1,h2,h3{padding:0}h1{padding-top:.5em}.title{font-size:24pt;font-weight:700}ol,p,pre,table,ul{margin:0}ol,ul{padding-left:1.5em}section>p{margin-bottom:16px}section>p:last-child{margin-bottom:0}.margin,aside{position:relative;float:right;clear:right;width:var(--margin-width);margin-right:calc(-1 * var(--gap-width) - var(--margin-width));margin-bottom:1em;vertical-align:unset}aside{margin-left:0;margin-top:0}aside>:first-child{margin-top:0}aside>:last-child{margin-bottom:0}.inlinenote-number{line-height:1;padding:1px}.float-left{float:left;margin-right:1em}.float-right{float:right;margin-left:1em}.sticky{position:sticky;top:0;z-index:10}.page{text-align:justify;width:calc(100vw - 2 * var(--article-padding) - 2 * var(--article-margin-left))}figure,pre{max-width:calc(100vw - 2 * var(--article-padding) - 2 * var(--article-margin-left));overflow-x:auto}.full{max-width:100vw}.full-image{width:100%;object-fit:cover;vertical-align:middle}.full figcaption{background:#eee;padding:16px 0}.centered{text-align:center}figure{margin:0;padding:5px 0}aside canvas,aside img,aside svg,figure canvas,figure img,figure svg{object-fit:contain;max-width:100%;height:auto}header{padding-bottom:1em}footer{padding:2em 0}@media (max-width:1100px){:root{--article-padding:16px}article{width:min(var(--max-article-width),calc(100% - var(--article-padding) * 2))}figure,pre{max-width:calc(100vw - var(--article-padding) * 2)}.page{width:min(var(--max-article-width),100%)}.margin,aside{float:none;margin:0;width:auto}.inline-note-number{cursor:pointer;padding:1px 4px}.inline-note .note::before,.inline-note:not(.open) .note{display:none}}@media print{.sticky{position:relative}}.error-block{display:block;border:1px solid red;padding:1em;max-width:800px;font-size:.9em}.quadtree{background-color:#fff;text-align:center;padding-top:20vh}svg.marks path,svg.marks text{transition:opacity .5s}body{font:16px/1.5 -apple-system,system-ui,BlinkMacSystemFont,"Segoe UI",Helvetica,Arial,sans-serif,"Apple Color Emoji","Segoe UI Emoji","Segoe UI Symbol";background:#fff;color:#000}:not(pre)>code,pre{font-family:monospace;font-size:15px}h1,h2,h3,h4,h5,h6{font-weight:600;line-height:1.25em;margin:24px 0 16px}h1,h2{border-bottom:1px solid rgba(0,0,0,.1);padding-bottom:6px;width:fit-content}.katex-display,article p,article>code-block>pre,article>ol,article>pre,article>table,article>ul{margin:12px 0}td,th{border-bottom:1px solid rgba(0,0,0,.2);transition:.1s ease-out}th,tr:hover td{background:rgba(0,0,0,.1)}figure>figcaption{font-weight:600;font-size:var(--small-size);line-height:1.4em;padding-bottom:1ex}.sticky{background:rgba(255,255,255,.8);backdrop-filter:blur(4px)}.note,aside{font-style:inherit;font-size:var(--small-size)}.note{background:#fff;transition:.1s ease-out}.inline-note:hover .inline-note-number,.inline-note:hover .note{background:var(--ref-color-light)}.inline-note .note::before{font-size:var(--smaller-size)}.normal{font-weight:400}.demi{font-weight:600}.bold,.strong{font-weight:700}.code,.mono{font-family:monospace}.em,.emph,.italic{font-style:italic}.highlight{background-color:var(--highlight-color)}.strike{text-decoration:line-through}.underline{text-decoration:underline}.smallcaps{font-variant:small-caps}.lowercase{text-transform:lowercase}.uppercase{text-transform:uppercase}.capitalize{text-transform:capitalize}.left{text-align:left}.right{text-align:right}.center{text-align:center}.justify{text-align:justify}.tiny{font-size:var(--tiny-size)}.scriptsize{font-size:var(--script-size)}.footnotesize,.smaller{font-size:var(--smaller-size)}.small{font-size:var(--small-size)}.large{font-size:var(--large-size)}.larger{font-size:var(--larger-size)}.huge{font-size:var(--huge-size)}.hide{display:none}:root{--margin-width:500px}.barnes-hut{margin-top:-20vh}.t00,.t00:hover{color:#3b0f70;text-decoration:underline 1px dashed rgb(59,15,112)}.t00:hover{filter:brightness(1.8)}.t05,.t05:hover{color:#8c2981;text-decoration:underline 1px dashed rgb(140,41,129)}.t05:hover{filter:brightness(1.5)}.t10,.t10:hover{color:#de4968;text-decoration:underline 1px dashed rgb(222,73,104)}.t10:hover{filter:brightness(1.5)}.t15,.t15:hover{color:#fe9f6d;text-decoration:underline 1px dashed rgb(254,159,109)}.t15:hover{filter:brightness(1.2)}
</style>
<body>
<article><header><h1 role="banner">The Barnes-Hut Approximation: Efficient computation of N-body forces</h1><div class="author"><span class="author-name">Jeffrey Heer</span><span class="author-org">University of Washington</span></div></header>

<aside class="margin sticky barnes-hut">
    <p><barnes-hut data-attr="1" width="500" height="500"></barnes-hut></p>
</aside>

<h1 id="introduction" data-counter="1">Introduction</h1><p>Computers are exciting tools for discovery, with which we can model and explore complex phenomena.
For example, to test theories about the formation of the universe, we can perform <em>simulations</em> to predict how galaxies evolve.
We could gather the estimated mass and location of stars and model their gravitational interactions over time.</p><p>Another avenue for discovery is to <em>visualize</em> complex information to reveal structure and patterns.
Consider this network diagram, showing connections between people in a social network. We can examine community groups and identify people who bridge between them.</p><p>Though they may seem quite different at first, these two examples share a common need.
They both require computing forces that arise from pairwise interactions among a set of points, often referred to as an <em>N-body problem</em>.
In the case of astronomical simulation, we seek to model the gravitational forces among stars.
In the case of network visualization, we compute the layout using a similar physical simulation: nodes in the network act as charged particles that repel each other, links act as springs that pull related nodes together.</p><p><em>To get a sense of how this force-directed layout works, drag the nodes or use the slider to adjust the force strength.</em>
Negative values indicate repulsive forces, while positive values indicate attractive forces.</p><cell-view class="js" data-bind="charge" data-cell="7"></cell-view><p>A straightforward approach to computing N-body forces is to consider all pairs of individual points and add up the contributions of each interaction.
This naïve scheme has <em>quadratic complexity</em>: as the number of points <em>n</em> increases, the running time grows proportionally to <em>n</em><sup>2</sup>, quickly leading to intractably long calculations.
How might we do better?</p><h1 id="the-barnes-hut-approximation" data-counter="2">The Barnes-Hut Approximation</h1><p>To accelerate computation and make large-scale simulations possible, the astronomers Josh Barnes and Piet Hut devised a clever scheme: approximate long-range forces by replacing a group of distant points with their center of mass.
In exchange for a small amount of error, this scheme significantly speeds up calculation, with complexity <em>n log n</em> rather than <em>n</em><sup>2</sup>.</p><p>Central to this approximation is a <em>spatial index</em>: a <q>map</q> of space that helps us model groups of points as a single center of mass.
In two dimensions, we use a <a href="https://en.wikipedia.org/wiki/Quadtree">quadtree</a> data structure, which subdivides square regions of space into four equal-sized quadrants.
(In three dimensions, an <a href="https://en.wikipedia.org/wiki/Octree">octree</a> divides a cubic volume into eight sub-cubes.)</p><p>The Barnes-Hut approximation involves three steps:</p><ol><li>Construct the spatial index (quadtree)</li><li>Calculate centers of mass</li><li>Estimate forces</li></ol><p>Let’s explore each step in turn.
We will assume we are computing <em>repulsive</em> forces for the purposes of network layout.
This setup is akin to modeling anti-gravity or electric forces with similarly-charged particles.
While we will use the term <q>center of mass</q>, this could readily be replaced with <q>center of charge</q>.</p><p><em>As you read through, click the <a data-attr="2" class="action">action links</a> to update the diagram!</em></p><h2 id="step-1-construct-the-quadtree" data-counter="2.1">Step 1: Construct the Quadtree</h2><p>We begin with <a data-attr="3" class="action">a set of two-dimensional input points</a>.
When we <a data-attr="4" class="action">insert the first point into the quadtree</a>, it is added to the top-level root cell of the tree.</p><p><a data-attr="5" class="action">When we insert another point</a>, the tree expands by subdiving the space.
With
<a data-attr="6" class="action">each</a>
<a data-attr="7" class="action">subsequent</a>
<a data-attr="8" class="action">insertion</a>,
more fine-grained cells are added until all points reside in their own cell.</p><p><em>Advance the slider to add each point and produce the full quadtree</em>.</p><cell-view class="js" data-bind="step" data-cell="8"></cell-view><h2 id="step-2-calculate-centers-of-mass" data-counter="2.2">Step 2: Calculate Centers of Mass</h2><p>After quadtree construction, <a data-attr="9" class="action">we calculate centers of mass for each cell of the tree</a>.
The center of mass of a quadtree cell is the weighted average of the centers of its four child cells.</p><p>We visit the leaf node cells first and then visit subsequent parent cells, merging data as we pass upwards through the tree.
Once the traversal completes, each cell has been updated with the position and strength of its center of mass.</p><h2 id="step-3-estimate-n-body-forces" data-counter="2.3">Step 3: Estimate N-Body Forces</h2><p>Now we are ready to estimate forces!</p><p><a data-attr="10" class="action">To measure forces at a given point, let’s add a <q>probe</q> <img alt="Probe icon" src="probe.svg"></img> to our diagram</a>.
The purple line extending from the probe indicates the direction and magnitude of the total force at that location.
(To promote visibility, the purple line is three times longer than the actual pixel distance the probe would be moved in a single timestep of the force simulation.)
The dotted lines extending to the probe represent the force components exerted by individual points.</p><p><em>Move the probe (click or drag) to explore the force field</em>.</p><p>Ignoring the quadtree, we can naïvely calculate forces by summing the contributions of <em>all</em> individual points.
Of course, we want to use the quadtree to accelerate calculation and approximate long-range forces.
Rather than compute interactions among individual points, <a data-attr="11" class="action">we can compute interactions with centers of mass</a>, using smaller quadtree cells for nearer points and larger cells for more distant points.</p><p>At this point we skipped a critical detail: what constitutes <q>long-range</q> versus <q>short-range</q> forces?
We consider both the <em>distance</em> to the center of a quadtree cell and that cell’s <em>width</em>.
If the ratio <em>width / distance</em> falls below a chosen threshold – a parameter Θ (<em>theta</em>) – we treat the quadtree cell as a source of long-range forces and use its center of mass.
Otherwise, we will recursively visit the child cells in the quadtree.</p><p>When Θ = 1, a quadtree cell’s center of mass will be used – and its internal points ignored – if the distance from the sample point to the cell’s center is greater than or equal to the cell’s width.</p><p><em>Adjust the Θ parameter to view its effect on force estimation</em>.</p><p>How does the number of considered points change based on the probe location and Θ?
How does the direction and magnitude of the total force vary with Θ?</p><cell-view class="js" data-bind-set="theta" data-cell="9"></cell-view><p>We can now perform force estimation for each individual point, using the Barnes-Hut approximation to limit the total number of comparisons!</p><h1 id="performance-analysis" data-counter="3">Performance Analysis</h1><p>To assess the performance of the Barnes-Hut approximation, we can look at
both the running time and accuracy of force estimation.
We will compare naïve (<em>n</em><sup>2</sup>) calculation to different settings of the Θ parameter.</p><p>We will take measurements using different point sets, ranging from 500 to 10,000 points.
For each point count, we average the results from 50 separate runs of force estimation, each time using a different set of points placed at uniformly random coordinates within a 900 x 500 pixel rectangle.</p><p><time-plot data-bind="focus"></time-plot></p><p>The running time results confirm that the Barnes-Hut approximation can significantly speed-up computation.
As expected, the <a data-attr="12" class="t00 action">naïve approach</a> exhibits a quadratic relationship, whereas increasing the Θ parameter leads to faster calculations.
A low setting of <a data-attr="13" class="t05 action">Θ = 0.5</a> does not fare better than the naïve approach until processing about 6,000 points.
Until that point, the overhead of quadtree construction and center of mass calculation outstrips any gains in force estimation.
In contrast, for <a data-attr="14" class="t10 action">Θ = 1</a> and <a data-attr="15" class="t15 action">Θ = 1.5</a> we see significant improvements in running time.</p><p>To evaluate approximation error, we measure the average vector distance between the results of the naïve scheme and Barnes-Hut.
In the context of a force-directed graph layout, this error represents the difference (in pixels) between node positions after applying the naïve and approximate methods.</p><p><error-plot data-bind="focus"></error-plot></p><p>Looking at the error results, we first see that the average error is relatively small: only ~5% of a single pixel in difference!
However, we should take care interpreting these results, as we use the <em>average</em> error per point and the <em>maximum</em> error may be substantially higher.
While <a data-attr="16" class="t10 action">Θ = 1</a> and <a data-attr="17" class="t15 action">Θ = 1.5</a> exhibit similar <em>running times</em>, here we see notably higher <em>error rates</em> for <a data-attr="18" class="t15 action">Θ = 1.5</a> versus <a data-attr="19" class="t10 action">Θ = 1</a> and <a data-attr="20" class="t05 action">Θ = 0.5</a>.</p><p>These results suggest that a good default value for Θ – with low running time <em>and</em> low approximation error – is around 1.0.
Indeed, in practice it is common to see default settings slightly below 1.
In visualization applications, where errors on the order of a few pixels are not a problem, even higher Θ values may be used without issue.</p><h1 id="conclusion" data-counter="4">Conclusion</h1><p>The Barnes-Hut approximation has had a major impact on both physical simulation and network visualization, enabling n-body calculations to scale to much larger data sets than naïve force calculation permits.</p><p><a data-attr="21" class="action">Returning to our initial network diagram</a>, we can use Barnes-Hut to efficiently compute repulsive forces at each timestep.
For each animation frame, we perform the approximation anew, creating a new quadtree, accumulating centers of mass, and (approximately) estimating forces.</p></article>
    <script type="module">
/**
 * @license
 * Copyright 2019 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
const e=window,t=e.ShadowRoot&&(void 0===e.ShadyCSS||e.ShadyCSS.nativeShadow)&&"adoptedStyleSheets"in Document.prototype&&"replace"in CSSStyleSheet.prototype,n=Symbol(),r=new WeakMap;const i=e=>new class{constructor(e,t,r){if(this._$cssResult$=!0,r!==n)throw Error("CSSResult is not constructable. Use `unsafeCSS` or `css` instead.");this.cssText=e,this.t=t}get styleSheet(){let e=this.o;const n=this.t;if(t&&void 0===e){const t=void 0!==n&&1===n.length;t&&(e=r.get(n)),void 0===e&&((this.o=e=new CSSStyleSheet).replaceSync(this.cssText),t&&r.set(n,e))}return e}toString(){return this.cssText}}("string"==typeof e?e:e+"",void 0,n),s=t?e=>e:e=>e instanceof CSSStyleSheet?(e=>{let t="";for(const n of e.cssRules)t+=n.cssText;return i(t)})(e):e
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */;var o;const a=window,l=a.trustedTypes,c=l?l.emptyScript:"",u=a.reactiveElementPolyfillSupport,d={toAttribute(e,t){switch(t){case Boolean:e=e?c:null;break;case Object:case Array:e=null==e?e:JSON.stringify(e)}return e},fromAttribute(e,t){let n=e;switch(t){case Boolean:n=null!==e;break;case Number:n=null===e?null:Number(e);break;case Object:case Array:try{n=JSON.parse(e)}catch(e){n=null}}return n}},h=(e,t)=>t!==e&&(t==t||e==e),f={attribute:!0,type:String,converter:d,reflect:!1,hasChanged:h};let p=class extends HTMLElement{constructor(){super(),this._$Ei=new Map,this.isUpdatePending=!1,this.hasUpdated=!1,this._$El=null,this.u()}static addInitializer(e){var t;null!==(t=this.h)&&void 0!==t||(this.h=[]),this.h.push(e)}static get observedAttributes(){this.finalize();const e=[];return this.elementProperties.forEach(((t,n)=>{const r=this._$Ep(n,t);void 0!==r&&(this._$Ev.set(r,n),e.push(r))})),e}static createProperty(e,t=f){if(t.state&&(t.attribute=!1),this.finalize(),this.elementProperties.set(e,t),!t.noAccessor&&!this.prototype.hasOwnProperty(e)){const n="symbol"==typeof e?Symbol():"__"+e,r=this.getPropertyDescriptor(e,n,t);void 0!==r&&Object.defineProperty(this.prototype,e,r)}}static getPropertyDescriptor(e,t,n){return{get(){return this[t]},set(r){const i=this[e];this[t]=r,this.requestUpdate(e,i,n)},configurable:!0,enumerable:!0}}static getPropertyOptions(e){return this.elementProperties.get(e)||f}static finalize(){if(this.hasOwnProperty("finalized"))return!1;this.finalized=!0;const e=Object.getPrototypeOf(this);if(e.finalize(),this.elementProperties=new Map(e.elementProperties),this._$Ev=new Map,this.hasOwnProperty("properties")){const e=this.properties,t=[...Object.getOwnPropertyNames(e),...Object.getOwnPropertySymbols(e)];for(const n of t)this.createProperty(n,e[n])}return this.elementStyles=this.finalizeStyles(this.styles),!0}static finalizeStyles(e){const t=[];if(Array.isArray(e)){const n=new Set(e.flat(1/0).reverse());for(const e of n)t.unshift(s(e))}else void 0!==e&&t.push(s(e));return t}static _$Ep(e,t){const n=t.attribute;return!1===n?void 0:"string"==typeof n?n:"string"==typeof e?e.toLowerCase():void 0}u(){var e;this._$E_=new Promise((e=>this.enableUpdating=e)),this._$AL=new Map,this._$Eg(),this.requestUpdate(),null===(e=this.constructor.h)||void 0===e||e.forEach((e=>e(this)))}addController(e){var t,n;(null!==(t=this._$ES)&&void 0!==t?t:this._$ES=[]).push(e),void 0!==this.renderRoot&&this.isConnected&&(null===(n=e.hostConnected)||void 0===n||n.call(e))}removeController(e){var t;null===(t=this._$ES)||void 0===t||t.splice(this._$ES.indexOf(e)>>>0,1)}_$Eg(){this.constructor.elementProperties.forEach(((e,t)=>{this.hasOwnProperty(t)&&(this._$Ei.set(t,this[t]),delete this[t])}))}createRenderRoot(){var n;const r=null!==(n=this.shadowRoot)&&void 0!==n?n:this.attachShadow(this.constructor.shadowRootOptions);return((n,r)=>{t?n.adoptedStyleSheets=r.map((e=>e instanceof CSSStyleSheet?e:e.styleSheet)):r.forEach((t=>{const r=document.createElement("style"),i=e.litNonce;void 0!==i&&r.setAttribute("nonce",i),r.textContent=t.cssText,n.appendChild(r)}))})(r,this.constructor.elementStyles),r}connectedCallback(){var e;void 0===this.renderRoot&&(this.renderRoot=this.createRenderRoot()),this.enableUpdating(!0),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostConnected)||void 0===t?void 0:t.call(e)}))}enableUpdating(e){}disconnectedCallback(){var e;null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostDisconnected)||void 0===t?void 0:t.call(e)}))}attributeChangedCallback(e,t,n){this._$AK(e,n)}_$EO(e,t,n=f){var r;const i=this.constructor._$Ep(e,n);if(void 0!==i&&!0===n.reflect){const s=(void 0!==(null===(r=n.converter)||void 0===r?void 0:r.toAttribute)?n.converter:d).toAttribute(t,n.type);this._$El=e,null==s?this.removeAttribute(i):this.setAttribute(i,s),this._$El=null}}_$AK(e,t){var n;const r=this.constructor,i=r._$Ev.get(e);if(void 0!==i&&this._$El!==i){const e=r.getPropertyOptions(i),s="function"==typeof e.converter?{fromAttribute:e.converter}:void 0!==(null===(n=e.converter)||void 0===n?void 0:n.fromAttribute)?e.converter:d;this._$El=i,this[i]=s.fromAttribute(t,e.type),this._$El=null}}requestUpdate(e,t,n){let r=!0;void 0!==e&&(((n=n||this.constructor.getPropertyOptions(e)).hasChanged||h)(this[e],t)?(this._$AL.has(e)||this._$AL.set(e,t),!0===n.reflect&&this._$El!==e&&(void 0===this._$EC&&(this._$EC=new Map),this._$EC.set(e,n))):r=!1),!this.isUpdatePending&&r&&(this._$E_=this._$Ej())}async _$Ej(){this.isUpdatePending=!0;try{await this._$E_}catch(e){Promise.reject(e)}const e=this.scheduleUpdate();return null!=e&&await e,!this.isUpdatePending}scheduleUpdate(){return this.performUpdate()}performUpdate(){var e;if(!this.isUpdatePending)return;this.hasUpdated,this._$Ei&&(this._$Ei.forEach(((e,t)=>this[t]=e)),this._$Ei=void 0);let t=!1;const n=this._$AL;try{t=this.shouldUpdate(n),t?(this.willUpdate(n),null===(e=this._$ES)||void 0===e||e.forEach((e=>{var t;return null===(t=e.hostUpdate)||void 0===t?void 0:t.call(e)})),this.update(n)):this._$Ek()}catch(e){throw t=!1,this._$Ek(),e}t&&this._$AE(n)}willUpdate(e){}_$AE(e){var t;null===(t=this._$ES)||void 0===t||t.forEach((e=>{var t;return null===(t=e.hostUpdated)||void 0===t?void 0:t.call(e)})),this.hasUpdated||(this.hasUpdated=!0,this.firstUpdated(e)),this.updated(e)}_$Ek(){this._$AL=new Map,this.isUpdatePending=!1}get updateComplete(){return this.getUpdateComplete()}getUpdateComplete(){return this._$E_}shouldUpdate(e){return!0}update(e){void 0!==this._$EC&&(this._$EC.forEach(((e,t)=>this._$EO(t,this[t],e))),this._$EC=void 0),this._$Ek()}updated(e){}firstUpdated(e){}};
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var m;p.finalized=!0,p.elementProperties=new Map,p.elementStyles=[],p.shadowRootOptions={mode:"open"},null==u||u({ReactiveElement:p}),(null!==(o=a.reactiveElementVersions)&&void 0!==o?o:a.reactiveElementVersions=[]).push("1.4.1");const v=window,_=v.trustedTypes,y=_?_.createPolicy("lit-html",{createHTML:e=>e}):void 0,b=`lit$${(Math.random()+"").slice(9)}$`,w="?"+b,g=`<${w}>`,E=document,x=(e="")=>E.createComment(e),$=e=>null===e||"object"!=typeof e&&"function"!=typeof e,A=Array.isArray,k=/<(?:(!--|\/[^a-zA-Z])|(\/?[a-zA-Z][^>\s]*)|(\/?$))/g,S=/-->/g,j=/>/g,C=RegExp(">|[ \t\n\f\r](?:([^\\s\"'>=/]+)([ \t\n\f\r]*=[ \t\n\f\r]*(?:[^ \t\n\f\r\"'`<>=]|(\"|')|))|$)","g"),N=/'/g,P=/"/g,O=/^(?:script|style|textarea|title)$/i,T=(e=>(t,...n)=>({_$litType$:e,strings:t,values:n}))(1),L=Symbol.for("lit-noChange"),M=Symbol.for("lit-nothing"),R=new WeakMap,U=E.createTreeWalker(E,129,null,!1),q=(e,t)=>{const n=e.length-1,r=[];let i,s=2===t?"<svg>":"",o=k;for(let t=0;t<n;t++){const n=e[t];let a,l,c=-1,u=0;for(;u<n.length&&(o.lastIndex=u,l=o.exec(n),null!==l);)u=o.lastIndex,o===k?"!--"===l[1]?o=S:void 0!==l[1]?o=j:void 0!==l[2]?(O.test(l[2])&&(i=RegExp("</"+l[2],"g")),o=C):void 0!==l[3]&&(o=C):o===C?">"===l[0]?(o=null!=i?i:k,c=-1):void 0===l[1]?c=-2:(c=o.lastIndex-l[2].length,a=l[1],o=void 0===l[3]?C:'"'===l[3]?P:N):o===P||o===N?o=C:o===S||o===j?o=k:(o=C,i=void 0);const d=o===C&&e[t+1].startsWith("/>")?" ":"";s+=o===k?n+g:c>=0?(r.push(a),n.slice(0,c)+"$lit$"+n.slice(c)+b+d):n+b+(-2===c?(r.push(void 0),t):d)}const a=s+(e[n]||"<?>")+(2===t?"</svg>":"");if(!Array.isArray(e)||!e.hasOwnProperty("raw"))throw Error("invalid template strings array");return[void 0!==y?y.createHTML(a):a,r]};class I{constructor({strings:e,_$litType$:t},n){let r;this.parts=[];let i=0,s=0;const o=e.length-1,a=this.parts,[l,c]=q(e,t);if(this.el=I.createElement(l,n),U.currentNode=this.el.content,2===t){const e=this.el.content,t=e.firstChild;t.remove(),e.append(...t.childNodes)}for(;null!==(r=U.nextNode())&&a.length<o;){if(1===r.nodeType){if(r.hasAttributes()){const e=[];for(const t of r.getAttributeNames())if(t.endsWith("$lit$")||t.startsWith(b)){const n=c[s++];if(e.push(t),void 0!==n){const e=r.getAttribute(n.toLowerCase()+"$lit$").split(b),t=/([.?@])?(.*)/.exec(n);a.push({type:1,index:i,name:t[2],strings:e,ctor:"."===t[1]?F:"?"===t[1]?V:"@"===t[1]?Z:B})}else a.push({type:6,index:i})}for(const t of e)r.removeAttribute(t)}if(O.test(r.tagName)){const e=r.textContent.split(b),t=e.length-1;if(t>0){r.textContent=_?_.emptyScript:"";for(let n=0;n<t;n++)r.append(e[n],x()),U.nextNode(),a.push({type:2,index:++i});r.append(e[t],x())}}}else if(8===r.nodeType)if(r.data===w)a.push({type:2,index:i});else{let e=-1;for(;-1!==(e=r.data.indexOf(b,e+1));)a.push({type:7,index:i}),e+=b.length-1}i++}}static createElement(e,t){const n=E.createElement("template");return n.innerHTML=e,n}}function D(e,t,n=e,r){var i,s,o,a;if(t===L)return t;let l=void 0!==r?null===(i=n._$Co)||void 0===i?void 0:i[r]:n._$Cl;const c=$(t)?void 0:t._$litDirective$;return(null==l?void 0:l.constructor)!==c&&(null===(s=null==l?void 0:l._$AO)||void 0===s||s.call(l,!1),void 0===c?l=void 0:(l=new c(e),l._$AT(e,n,r)),void 0!==r?(null!==(o=(a=n)._$Co)&&void 0!==o?o:a._$Co=[])[r]=l:n._$Cl=l),void 0!==l&&(t=D(e,l._$AS(e,t.values),l,r)),t}class H{constructor(e,t){this.u=[],this._$AN=void 0,this._$AD=e,this._$AM=t}get parentNode(){return this._$AM.parentNode}get _$AU(){return this._$AM._$AU}v(e){var t;const{el:{content:n},parts:r}=this._$AD,i=(null!==(t=null==e?void 0:e.creationScope)&&void 0!==t?t:E).importNode(n,!0);U.currentNode=i;let s=U.nextNode(),o=0,a=0,l=r[0];for(;void 0!==l;){if(o===l.index){let t;2===l.type?t=new z(s,s.nextSibling,this,e):1===l.type?t=new l.ctor(s,l.name,l.strings,this,e):6===l.type&&(t=new G(s,this,e)),this.u.push(t),l=r[++a]}o!==(null==l?void 0:l.index)&&(s=U.nextNode(),o++)}return i}p(e){let t=0;for(const n of this.u)void 0!==n&&(void 0!==n.strings?(n._$AI(e,n,t),t+=n.strings.length-2):n._$AI(e[t])),t++}}class z{constructor(e,t,n,r){var i;this.type=2,this._$AH=M,this._$AN=void 0,this._$AA=e,this._$AB=t,this._$AM=n,this.options=r,this._$Cm=null===(i=null==r?void 0:r.isConnected)||void 0===i||i}get _$AU(){var e,t;return null!==(t=null===(e=this._$AM)||void 0===e?void 0:e._$AU)&&void 0!==t?t:this._$Cm}get parentNode(){let e=this._$AA.parentNode;const t=this._$AM;return void 0!==t&&11===e.nodeType&&(e=t.parentNode),e}get startNode(){return this._$AA}get endNode(){return this._$AB}_$AI(e,t=this){e=D(this,e,t),$(e)?e===M||null==e||""===e?(this._$AH!==M&&this._$AR(),this._$AH=M):e!==this._$AH&&e!==L&&this.g(e):void 0!==e._$litType$?this.$(e):void 0!==e.nodeType?this.T(e):(e=>A(e)||"function"==typeof(null==e?void 0:e[Symbol.iterator]))(e)?this.k(e):this.g(e)}O(e,t=this._$AB){return this._$AA.parentNode.insertBefore(e,t)}T(e){this._$AH!==e&&(this._$AR(),this._$AH=this.O(e))}g(e){this._$AH!==M&&$(this._$AH)?this._$AA.nextSibling.data=e:this.T(E.createTextNode(e)),this._$AH=e}$(e){var t;const{values:n,_$litType$:r}=e,i="number"==typeof r?this._$AC(e):(void 0===r.el&&(r.el=I.createElement(r.h,this.options)),r);if((null===(t=this._$AH)||void 0===t?void 0:t._$AD)===i)this._$AH.p(n);else{const e=new H(i,this),t=e.v(this.options);e.p(n),this.T(t),this._$AH=e}}_$AC(e){let t=R.get(e.strings);return void 0===t&&R.set(e.strings,t=new I(e)),t}k(e){A(this._$AH)||(this._$AH=[],this._$AR());const t=this._$AH;let n,r=0;for(const i of e)r===t.length?t.push(n=new z(this.O(x()),this.O(x()),this,this.options)):n=t[r],n._$AI(i),r++;r<t.length&&(this._$AR(n&&n._$AB.nextSibling,r),t.length=r)}_$AR(e=this._$AA.nextSibling,t){var n;for(null===(n=this._$AP)||void 0===n||n.call(this,!1,!0,t);e&&e!==this._$AB;){const t=e.nextSibling;e.remove(),e=t}}setConnected(e){var t;void 0===this._$AM&&(this._$Cm=e,null===(t=this._$AP)||void 0===t||t.call(this,e))}}class B{constructor(e,t,n,r,i){this.type=1,this._$AH=M,this._$AN=void 0,this.element=e,this.name=t,this._$AM=r,this.options=i,n.length>2||""!==n[0]||""!==n[1]?(this._$AH=Array(n.length-1).fill(new String),this.strings=n):this._$AH=M}get tagName(){return this.element.tagName}get _$AU(){return this._$AM._$AU}_$AI(e,t=this,n,r){const i=this.strings;let s=!1;if(void 0===i)e=D(this,e,t,0),s=!$(e)||e!==this._$AH&&e!==L,s&&(this._$AH=e);else{const r=e;let o,a;for(e=i[0],o=0;o<i.length-1;o++)a=D(this,r[n+o],t,o),a===L&&(a=this._$AH[o]),s||(s=!$(a)||a!==this._$AH[o]),a===M?e=M:e!==M&&(e+=(null!=a?a:"")+i[o+1]),this._$AH[o]=a}s&&!r&&this.j(e)}j(e){e===M?this.element.removeAttribute(this.name):this.element.setAttribute(this.name,null!=e?e:"")}}class F extends B{constructor(){super(...arguments),this.type=3}j(e){this.element[this.name]=e===M?void 0:e}}const W=_?_.emptyScript:"";class V extends B{constructor(){super(...arguments),this.type=4}j(e){e&&e!==M?this.element.setAttribute(this.name,W):this.element.removeAttribute(this.name)}}class Z extends B{constructor(e,t,n,r,i){super(e,t,n,r,i),this.type=5}_$AI(e,t=this){var n;if((e=null!==(n=D(this,e,t,0))&&void 0!==n?n:M)===L)return;const r=this._$AH,i=e===M&&r!==M||e.capture!==r.capture||e.once!==r.once||e.passive!==r.passive,s=e!==M&&(r===M||i);i&&this.element.removeEventListener(this.name,this,r),s&&this.element.addEventListener(this.name,this,e),this._$AH=e}handleEvent(e){var t,n;"function"==typeof this._$AH?this._$AH.call(null!==(n=null===(t=this.options)||void 0===t?void 0:t.host)&&void 0!==n?n:this.element,e):this._$AH.handleEvent(e)}}class G{constructor(e,t,n){this.element=e,this.type=6,this._$AN=void 0,this._$AM=t,this.options=n}get _$AU(){return this._$AM._$AU}_$AI(e){D(this,e)}}const Y=v.litHtmlPolyfillSupport;null==Y||Y(I,z),(null!==(m=v.litHtmlVersions)&&void 0!==m?m:v.litHtmlVersions=[]).push("2.4.0");
/**
 * @license
 * Copyright 2017 Google LLC
 * SPDX-License-Identifier: BSD-3-Clause
 */
var K,J;class Q extends p{constructor(){super(...arguments),this.renderOptions={host:this},this._$Do=void 0}createRenderRoot(){var e,t;const n=super.createRenderRoot();return null!==(e=(t=this.renderOptions).renderBefore)&&void 0!==e||(t.renderBefore=n.firstChild),n}update(e){const t=this.render();this.hasUpdated||(this.renderOptions.isConnected=this.isConnected),super.update(e),this._$Do=((e,t,n)=>{var r,i;const s=null!==(r=null==n?void 0:n.renderBefore)&&void 0!==r?r:t;let o=s._$litPart$;if(void 0===o){const e=null!==(i=null==n?void 0:n.renderBefore)&&void 0!==i?i:null;s._$litPart$=o=new z(t.insertBefore(x(),e),e,void 0,null!=n?n:{})}return o._$AI(e),o})(t,this.renderRoot,this.renderOptions)}connectedCallback(){var e;super.connectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!0)}disconnectedCallback(){var e;super.disconnectedCallback(),null===(e=this._$Do)||void 0===e||e.setConnected(!1)}render(){return L}}Q.finalized=!0,Q._$litElement$=!0,null===(K=globalThis.litElementHydrateSupport)||void 0===K||K.call(globalThis,{LitElement:Q});const X=globalThis.litElementPolyfillSupport;null==X||X({LitElement:Q}),(null!==(J=globalThis.litElementVersions)&&void 0!==J?J:globalThis.litElementVersions=[]).push("3.2.2");class ee{constructor(e,t,n){this.runtime=e,this.name=t,this.value=n,this.paused=!1,this.ignore=null,this.queued=[],this.inputs=new Map,e.variable(null,(e=>e),[t],{fulfilled:e=>this.paused?this.dequeue():this.update(e)})}add(e,{override:t=!1,event:n=ne(e),valueof:r=te}={}){t?this.update(r(e)):r(e,this.value);const i=()=>this.queue(e,r(e));return this.inputs.set(e,{input:e,event:n,listener:i,valueof:r}),e.addEventListener(n,i),this}addCell(e,t){let n;return e.addEventListener("change",(async()=>{const r=e.value;r!==n&&(n&&this.delete(n),this.add(n=r,t))})),this}delete(e){const{event:t,listener:n}=this.inputs.get(e);e.removeEventListener(t,n),this.inputs.delete(e)}queue(e,t){this.ignore!==e&&(this.paused||this.queued.length||function(e){"undefined"!=typeof window&&window.requestAnimationFrame?window.requestAnimationFrame(e):setTimeout(e,0)}((()=>this.dequeue())),this.queued.push(t))}dequeue(){if(this.paused=!1,this.queued.length){const e=this.queued;this.queued=[],this.update(e.pop())}}update(e){if(this.value!==e){this.value=e,this.paused=!0;for(const{input:t,event:n,valueof:r}of this.inputs.values())r(t)!==e&&(this.ignore=t,r(t,e),t.dispatchEvent(new Event(n)),this.ignore=null);this.runtime.redefine(this.name,e)}}}function te(e,t){if(arguments.length>1)switch(e.type){case"date":return e.valueAsDate=t;case"checkbox":return e.checked=t;default:return e.value=t}else switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;default:return e.value}}function ne(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";default:return"input"}}class re{constructor(e){this.status="pending",this.value=void 0,this.callback=e}promise(){switch(this.status){case"fulfilled":return Promise.resolve(this.value);case"rejected":return Promise.reject(this.value.error);case"pending":return this._promise||(this._promise=new Promise(((e,t)=>{this._resolve=e,this._reject=t})))}}update(e,t){this.status=e,"pending"!==e&&(this.value=t),this.callback(this.status,this.value)}pending(){this.update("pending",void 0)}fulfilled(e){this.update("fulfilled",e),this._promise&&(this._resolve(e),this._promise=this._resolve=this._reject=null)}rejected(e,t){this.update("rejected",{error:e,name:t}),this._promise&&(this._reject(e),this._promise=this._resolve=this._reject=null)}}function ie(e,t,n,r={}){const{cells:i=(()=>[]),attrs:s=(()=>[]),event:o=(()=>[])}=n,a=function(e){const t=new Map;return e.querySelectorAll("[data-attr]").forEach((e=>{t.set(e.getAttribute("data-attr"),e)})),e=>"object"==typeof e?e:t.get(e)}(t);e.define(i(),function(e){const t=new Map;return e.querySelectorAll("cell-view").forEach((e=>{t.set(+e.getAttribute("data-cell"),e.observer)})),e=>t.get(e.cell)}(t)),e.define(s(),function(e,t){return n=>{const[r,i]=t[n.cell],s=e(r),o=new re(((e,t)=>{"fulfilled"===e?s.setAttribute(i,t):"rejected"===e&&console.error(t.error)}));return s.observers=s.observers||new Map,s.observers.set(i,o),o}}(a,r.attrs)),e.define(o(),function(e,t,n){return r=>{const{define:[i],cell:s}=r,[o,a]=t[s];return e(o).addEventListener(a,n.handler(i)),{rejected(e){console.error(e)}}}}(a,r.events,e)),function(e,t){const n=new Map,r=(t,r)=>{e.querySelectorAll(`[${t}]`).forEach((e=>{const i=e.getAttribute(t),s={el:e,override:r};n.has(i)?n.get(i).push(s):n.set(i,[s])}))};r("data-bind",!1),r("data-bind-set",!0);const i=(e,{el:t,override:n})=>{"cell-view"===t.tagName.toLowerCase()?e.addCell(t,{override:n}):e.add(t,{override:n})};n.forEach(((e,n)=>{(async function(e,t){return new ee(e,t,await e.value(t))})(t,n).then((t=>{e.forEach((e=>i(t,e)))}))}))}(t,e)}const{getPrototypeOf:se,getOwnPropertyDescriptors:oe}=Object;se({});var ae={},le={};function ce(e){return new Function("d","return {"+e.map((function(e,t){return JSON.stringify(e)+": d["+t+'] || ""'})).join(",")+"}")}function ue(e){var t=Object.create(null),n=[];return e.forEach((function(e){for(var r in e)r in t||n.push(t[r]=r)})),n}function de(e,t){var n=e+"",r=n.length;return r<t?new Array(t-r+1).join(0)+n:n}function he(e){var t,n=e.getUTCHours(),r=e.getUTCMinutes(),i=e.getUTCSeconds(),s=e.getUTCMilliseconds();return isNaN(e)?"Invalid Date":((t=e.getUTCFullYear())<0?"-"+de(-t,6):t>9999?"+"+de(t,6):de(t,4))+"-"+de(e.getUTCMonth()+1,2)+"-"+de(e.getUTCDate(),2)+(s?"T"+de(n,2)+":"+de(r,2)+":"+de(i,2)+"."+de(s,3)+"Z":i?"T"+de(n,2)+":"+de(r,2)+":"+de(i,2)+"Z":r||n?"T"+de(n,2)+":"+de(r,2)+"Z":"")}function fe(e){var t=new RegExp('["'+e+"\n\r]"),n=e.charCodeAt(0);function r(e,t){var r,i=[],s=e.length,o=0,a=0,l=s<=0,c=!1;function u(){if(l)return le;if(c)return c=!1,ae;var t,r,i=o;if(34===e.charCodeAt(i)){for(;o++<s&&34!==e.charCodeAt(o)||34===e.charCodeAt(++o););return(t=o)>=s?l=!0:10===(r=e.charCodeAt(o++))?c=!0:13===r&&(c=!0,10===e.charCodeAt(o)&&++o),e.slice(i+1,t-1).replace(/""/g,'"')}for(;o<s;){if(10===(r=e.charCodeAt(t=o++)))c=!0;else if(13===r)c=!0,10===e.charCodeAt(o)&&++o;else if(r!==n)continue;return e.slice(i,t)}return l=!0,e.slice(i,s)}for(10===e.charCodeAt(s-1)&&--s,13===e.charCodeAt(s-1)&&--s;(r=u())!==le;){for(var d=[];r!==ae&&r!==le;)d.push(r),r=u();t&&null==(d=t(d,a++))||i.push(d)}return i}function i(t,n){return t.map((function(t){return n.map((function(e){return o(t[e])})).join(e)}))}function s(t){return t.map(o).join(e)}function o(e){return null==e?"":e instanceof Date?he(e):t.test(e+="")?'"'+e.replace(/"/g,'""')+'"':e}return{parse:function(e,t){var n,i,s=r(e,(function(e,r){if(n)return n(e,r-1);i=e,n=t?function(e,t){var n=ce(e);return function(r,i){return t(n(r),i,e)}}(e,t):ce(e)}));return s.columns=i||[],s},parseRows:r,format:function(t,n){return null==n&&(n=ue(t)),[n.map(o).join(e)].concat(i(t,n)).join("\n")},formatBody:function(e,t){return null==t&&(t=ue(e)),i(e,t).join("\n")},formatRows:function(e){return e.map(s).join("\n")},formatRow:s,formatValue:o}}var pe=fe(","),me=pe.parse,ve=pe.parseRows,_e=fe("\t"),ye=_e.parse,be=_e.parseRows;function we(e){for(var t in e){var n,r,i=e[t].trim();if(i)if("true"===i)i=!0;else if("false"===i)i=!1;else if("NaN"===i)i=NaN;else if(isNaN(n=+i)){if(!(r=i.match(/^([-+]\d{2})?\d{4}(-\d{2}(-\d{2})?)?(T\d{2}:\d{2}(:\d{2}(\.\d{3})?)?(Z|[-+]\d{2}:\d{2})?)?$/)))continue;ge&&r[4]&&!r[7]&&(i=i.replace(/-/g,"/").replace(/T/," ")),i=new Date(i)}else i=n;else i=null;e[t]=i}return e}const ge=new Date("2019-01-01T00:00").getHours()||new Date("2019-07-01T00:00").getHours();function Ee(e,t,n){return{resolve:(r=n)=>`${e}@${t}/${r}`}}const xe=Ee("d3","7.6.1","dist/d3.min.js"),$e=Ee("@observablehq/inputs","0.10.4","dist/inputs.min.js"),Ae=Ee("@observablehq/plot","0.6.0","dist/plot.umd.min.js"),ke=Ee("@observablehq/graphviz","0.2.1","dist/graphviz.min.js"),Se=Ee("@observablehq/highlight.js","2.0.0","highlight.min.js"),je=Ee("@observablehq/katex","0.11.1","dist/katex.min.js"),Ce=Ee("lodash","4.17.21","lodash.min.js"),Ne=Ee("htl","0.3.1","dist/htl.min.js"),Pe=Ee("jszip","3.10.0","dist/jszip.min.js"),Oe=Ee("marked","0.3.12","marked.min.js"),Te=Ee("sql.js","1.7.0","dist/sql-wasm.js"),Le=Ee("vega","5.22.1","build/vega.min.js"),Me=Ee("vega-lite","5.5.0","build/vega-lite.min.js"),Re=Ee("vega-lite-api","5.0.0","build/vega-lite-api.min.js"),Ue=Ee("apache-arrow","4.0.1","Arrow.es2015.min.js"),qe=Ee("arquero","4.8.8","dist/arquero.min.js"),Ie=Ee("topojson-client","3.1.0","dist/topojson-client.min.js"),De=Ee("exceljs","4.3.0","dist/exceljs.min.js"),He=Ee("mermaid","9.1.6","dist/mermaid.min.js"),ze=Ee("leaflet","1.8.0","dist/leaflet.js"),Be=new Map,Fe=[],We=Fe.map,Ve=Fe.some,Ze=Fe.hasOwnProperty,Ge=/^((?:@[^/@]+\/)?[^/@]+)(?:@([^/]+))?(?:\/(.*))?$/,Ye=/^\d+\.\d+\.\d+(-[\w-.+]+)?$/,Ke=/(?:\.[^/]*|\/)$/;class Je extends Error{constructor(e){super(e)}}function Qe(e){const t=Ge.exec(e);return t&&{name:t[1],version:t[2],path:t[3]}}function Xe(e="https://cdn.jsdelivr.net/npm/",t=["unpkg","jsdelivr","browser","main"]){if(!/\/$/.test(e))throw new Error("origin lacks trailing slash");function n(t){const n=`${e}${t.name}${t.version?`@${t.version}`:""}/package.json`;let r=Be.get(n);return r||Be.set(n,r=fetch(n).then((e=>{if(!e.ok)throw new Je("unable to load package.json");return e.redirected&&!Be.has(e.url)&&Be.set(e.url,r),e.json()}))),r}return async function(r,i){if(r.startsWith(e)&&(r=r.substring(e.length)),/^(\w+:)|\/\//i.test(r))return r;if(/^[.]{0,2}\//i.test(r))return new URL(r,i??location).href;if(!r.length||/^[\s._]/.test(r)||/\s$/.test(r))throw new Je("illegal name");const s=Qe(r);if(!s)return`${e}${r}`;if(!s.version&&null!=i&&i.startsWith(e)){const t=await n(Qe(i.substring(e.length)));s.version=t.dependencies&&t.dependencies[s.name]||t.peerDependencies&&t.peerDependencies[s.name]}if(s.path&&!Ke.test(s.path)&&(s.path+=".js"),s.path&&s.version&&Ye.test(s.version))return`${e}${s.name}@${s.version}/${s.path}`;const o=await n(s);return`${e}${o.name}@${o.version}/${s.path||function(e){for(const n of t){let t=e[n];if("string"==typeof t)return t.startsWith("./")&&(t=t.slice(2)),Ke.test(t)?t:`${t}.js`}}(o)||"index.js"}`}}Je.prototype.name=Je.name;var et=tt(Xe());function tt(e){const t=new Map,n=i(null);function r(e){if("string"!=typeof e)return e;let n=t.get(e);return n||t.set(e,n=new Promise(((t,n)=>{const r=document.createElement("script");r.onload=()=>{try{t(Fe.pop()(i(e)))}catch(e){n(new Je("invalid module"))}r.remove()},r.onerror=()=>{n(new Je("unable to load module")),r.remove()},r.async=!0,r.src=e,window.define=st,document.head.appendChild(r)}))),n}function i(t){return n=>Promise.resolve(e(n,t)).then(r)}function s(e){return arguments.length>1?Promise.all(We.call(arguments,n)).then(nt):n(e)}return s.alias=function(t){return tt(((n,r)=>n in t&&(r=null,"string"!=typeof(n=t[n]))?n:e(n,r)))},s.resolve=e,s}function nt(e){const t={};for(const n of e)for(const e in n)Ze.call(n,e)&&(null==n[e]?Object.defineProperty(t,e,{get:rt(n,e)}):t[e]=n[e]);return t}function rt(e,t){return()=>e[t]}function it(e){return"exports"===(e+="")||"module"===e}function st(e,t,n){const r=arguments.length;r<2?(n=e,t=[]):r<3&&(n=t,t="string"==typeof e?[]:e),Fe.push(Ve.call(t,it)?e=>{const r={},i={exports:r};return Promise.all(We.call(t,(t=>"exports"===(t+="")?r:"module"===t?i:e(t)))).then((e=>(n.apply(null,e),i.exports)))}:e=>Promise.all(We.call(t,e)).then((e=>"function"==typeof n?n.apply(null,e):n)))}st.amd={};let ot=et;async function at(e){const[t,n]=await Promise.all([e(Te.resolve()),e.resolve(Te.resolve("dist/"))]);return t({locateFile:e=>`${n}${e}`})}class lt{constructor(e){Object.defineProperties(this,{_db:{value:e}})}static async open(e){const[t,n]=await Promise.all([at(ot),Promise.resolve(e).then(ut)]);return new lt(new t.Database(n))}async query(e,t){return await async function(e,t,n){const[r]=await e.exec(t,n);if(!r)return[];const{columns:i,values:s}=r,o=s.map((e=>Object.fromEntries(e.map(((e,t)=>[i[t],e])))));return o.columns=i,o}(this._db,e,t)}async queryRow(e,t){return(await this.query(e,t))[0]||null}async explain(e,t){return dt("pre",{className:"observablehq--inspect"},[ht((await this.query(`EXPLAIN QUERY PLAN ${e}`,t)).map((e=>e.detail)).join("\n"))])}async describeTables({schema:e}={}){return this.query(`SELECT NULLIF(schema, 'main') AS schema, name FROM pragma_table_list() WHERE type = 'table'${null==e?"":" AND schema = ?"} AND name NOT LIKE 'sqlite_%'`,null==e?[]:[e])}async describeColumns({schema:e,table:t}={}){if(null==t)throw new Error("missing table");const n=await this.query(`SELECT name, type, "notnull" FROM pragma_table_info(?${null==e?"":", ?"}) ORDER BY cid`,null==e?[t]:[t,e]);if(!n.length)throw new Error(`table not found: ${t}`);return n.map((({name:e,type:t,notnull:n})=>({name:e,type:ct(t),databaseType:t,nullable:!n})))}async describe(e){const t=await(void 0===e?this.query("SELECT name FROM sqlite_master WHERE type = 'table'"):this.query("SELECT * FROM pragma_table_info(?)",[e]));if(!t.length)throw new Error("Not found");const{columns:n}=t;return dt("table",{value:t},[dt("thead",[dt("tr",n.map((e=>dt("th",[ht(e)]))))]),dt("tbody",t.map((e=>dt("tr",n.map((t=>dt("td",[ht(e[t])])))))))])}async sql(){return this.query(...this.queryTag.apply(this,arguments))}queryTag(e,...t){return[e.join("?"),t]}}function ct(e){switch(e){case"NULL":return"null";case"INT":case"INTEGER":case"TINYINT":case"SMALLINT":case"MEDIUMINT":case"BIGINT":case"UNSIGNED BIG INT":case"INT2":case"INT8":return"integer";case"TEXT":case"CLOB":case"DATE":case"DATETIME":return"string";case"REAL":case"DOUBLE":case"DOUBLE PRECISION":case"FLOAT":case"NUMERIC":return"number";case"BLOB":return"buffer";default:return/^(?:(?:(?:VARYING|NATIVE) )?CHARACTER|(?:N|VAR|NVAR)CHAR)\(/.test(e)?"string":/^(?:DECIMAL|NUMERIC)\(/.test(e)?"number":"other"}}function ut(e){return"string"==typeof e?fetch(e).then(ut):e instanceof Response||e instanceof Blob?e.arrayBuffer().then(ut):e instanceof ArrayBuffer?new Uint8Array(e):e}function dt(e,t,n){2===arguments.length&&(n=t,t=void 0);const r=document.createElement(e);if(void 0!==t)for(const e in t)r[e]=t[e];if(void 0!==n)for(const e of n)r.appendChild(e);return r}function ht(e){return document.createTextNode(e)}Object.defineProperty(lt.prototype,"dialect",{value:"sqlite"});class ft{constructor(e){Object.defineProperties(this,{_:{value:e},sheetNames:{value:e.worksheets.map((e=>e.name)),enumerable:!0}})}sheet(e,t){const n="number"==typeof e?this.sheetNames[e]:this.sheetNames.includes(e+="")?e:null;if(null==n)throw new Error(`Sheet not found: ${e}`);return function(e,{range:t,headers:n}={}){let[[r,i],[s,o]]=function(e=":",{columnCount:t,rowCount:n}){if(!(e+="").match(/^[A-Z]*\d*:[A-Z]*\d*$/))throw new Error("Malformed range specifier");const[[r=0,i=0],[s=t-1,o=n-1]]=e.split(":").map(_t);return[[r,i],[s,o]]}(t,e);const a=n?e._rows[i++]:null;let l=new Set(["#"]);for(let e=r;e<=s;e++){const t=a?pt(a.findCell(e+1)):null;let n=t&&t+""||vt(e);for(;l.has(n);)n+="_";l.add(n)}l=new Array(r).concat(Array.from(l));const c=new Array(o-i+1);for(let t=i;t<=o;t++){const n=c[t-i]=Object.create(null,{"#":{value:t+1}}),o=e.getRow(t+1);if(o.hasValues)for(let e=r;e<=s;e++){const t=pt(o.findCell(e+1));null!=t&&(n[l[e+1]]=t)}}return c.columns=l.filter((()=>!0)),c}(this._.getWorksheet(n),t)}}function pt(e){if(!e)return;const{value:t}=e;if(t&&"object"==typeof t&&!(t instanceof Date)){if(t.formula||t.sharedFormula)return t.result&&t.result.error?NaN:t.result;if(t.richText)return mt(t);if(t.text){let{text:e}=t;return e.richText&&(e=mt(e)),t.hyperlink&&t.hyperlink!==e?`${t.hyperlink} ${e}`:e}return t}return t}function mt(e){return e.richText.map((e=>e.text)).join("")}function vt(e){let t="";e++;do{t=String.fromCharCode(64+(e%26||26))+t}while(e=Math.floor((e-1)/26));return t}function _t(e){const[,t,n]=e.match(/^([A-Z]*)(\d*)$/);let r=0;if(t)for(let e=0;e<t.length;e++)r+=Math.pow(26,t.length-e-1)*(t.charCodeAt(e)-64);return[r?r-1:void 0,n?+n-1:void 0]}async function yt(e){const t=await fetch(await e.url());if(!t.ok)throw new Error(`Unable to load file: ${e.name}`);return t}async function bt(e,t,{array:n=!1,typed:r=!1}={}){const i=await e.text();return("\t"===t?n?be:ye:n?ve:me)(i,r&&we)}class wt{constructor(e,t){Object.defineProperty(this,"name",{value:e,enumerable:!0}),void 0!==t&&Object.defineProperty(this,"mimeType",{value:t+"",enumerable:!0})}async blob(){return(await yt(this)).blob()}async arrayBuffer(){return(await yt(this)).arrayBuffer()}async text(){return(await yt(this)).text()}async json(){return(await yt(this)).json()}async stream(){return(await yt(this)).body}async csv(e){return bt(this,",",e)}async tsv(e){return bt(this,"\t",e)}async image(e){const t=await this.url();return new Promise(((n,r)=>{const i=new Image;new URL(t,document.baseURI).origin!==new URL(location).origin&&(i.crossOrigin="anonymous"),Object.assign(i,e),i.onload=()=>n(i),i.onerror=()=>r(new Error(`Unable to load file: ${this.name}`)),i.src=t}))}async arrow(){const[e,t]=await Promise.all([ot(Ue.resolve()),yt(this)]);return e.Table.from(t)}async sqlite(){return lt.open(yt(this))}async zip(){const[e,t]=await Promise.all([ot(Pe.resolve()),this.arrayBuffer()]);return new xt(await e.loadAsync(t))}async xml(e="application/xml"){return(new DOMParser).parseFromString(await this.text(),e)}async html(){return this.xml("text/html")}async xlsx(){const[e,t]=await Promise.all([ot(De.resolve()),this.arrayBuffer()]);return new ft(await(new e.Workbook).xlsx.load(t))}}let gt=class extends wt{constructor(e,t,n){super(t,n),Object.defineProperty(this,"_url",{value:e})}async url(){return await this._url+""}};function Et(e){throw new Error(`File not found: ${e}`)}class xt{constructor(e){Object.defineProperty(this,"_",{value:e}),this.filenames=Object.keys(e.files).filter((t=>!e.files[t].dir))}file(e){const t=this._.file(e+="");if(!t||t.dir)throw new Error(`file not found: ${e}`);return new $t(t)}}class $t extends wt{constructor(e){super(e.name),Object.defineProperty(this,"_",{value:e}),Object.defineProperty(this,"_url",{writable:!0})}async url(){return this._url||(this._url=this.blob().then(URL.createObjectURL))}async blob(){return this._.async("blob")}async arrayBuffer(){return this._.async("arraybuffer")}async text(){return this._.async("text")}async json(){return JSON.parse(await this.text())}}var At={math:"http://www.w3.org/1998/Math/MathML",svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};var kt=0;function St(e){return new jt("O-"+(null==e?"":e+"-")+ ++kt)}function jt(e){this.id=e,this.href=new URL(`#${e}`,location)+""}jt.prototype.toString=function(){return"url("+this.href+")"};var Ct={canvas:function(e,t){var n=document.createElement("canvas");return n.width=e,n.height=t,n},context2d:function(e,t,n){null==n&&(n=devicePixelRatio);var r=document.createElement("canvas");r.width=e*n,r.height=t*n,r.style.width=e+"px";var i=r.getContext("2d");return i.scale(n,n),i},download:function(e,t="untitled",n="Save"){const r=document.createElement("a"),i=r.appendChild(document.createElement("button"));async function s(){await new Promise(requestAnimationFrame),URL.revokeObjectURL(r.href),r.removeAttribute("href"),i.textContent=n,i.disabled=!1}return i.textContent=n,r.download=t,r.onclick=async t=>{if(i.disabled=!0,r.href)return s();i.textContent="Saving…";try{const t=await("function"==typeof e?e():e);i.textContent="Download",r.href=URL.createObjectURL(t)}catch(e){i.textContent=n}if(t.eventPhase)return s();i.disabled=!1},r},element:function(e,t){var n,r=e+="",i=r.indexOf(":");i>=0&&"xmlns"!==(r=e.slice(0,i))&&(e=e.slice(i+1));var s=At.hasOwnProperty(r)?document.createElementNS(At[r],e):document.createElement(e);if(t)for(var o in t)i=(r=o).indexOf(":"),n=t[o],i>=0&&"xmlns"!==(r=o.slice(0,i))&&(o=o.slice(i+1)),At.hasOwnProperty(r)?s.setAttributeNS(At[r],o,n):s.setAttribute(o,n);return s},input:function(e){var t=document.createElement("input");return null!=e&&(t.type=e),t},range:function(e,t,n){1===arguments.length&&(t=e,e=null);var r=document.createElement("input");return r.min=e=null==e?0:+e,r.max=t=null==t?1:+t,r.step=null==n?"any":n=+n,r.type="range",r},select:function(e){var t=document.createElement("select");return Array.prototype.forEach.call(e,(function(e){var n=document.createElement("option");n.value=n.textContent=e,t.appendChild(n)})),t},svg:function(e,t){var n=document.createElementNS("http://www.w3.org/2000/svg","svg");return n.setAttribute("viewBox",[0,0,e,t]),n.setAttribute("width",e),n.setAttribute("height",t),n},text:function(e){return document.createTextNode(e)},uid:St};var Nt={buffer:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsArrayBuffer(e)}))},text:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsText(e)}))},url:function(e){return new Promise((function(t,n){var r=new FileReader;r.onload=function(){t(r.result)},r.onerror=n,r.readAsDataURL(e)}))}};function Pt(){return this}function Ot(e,t){let n=!1;if("function"!=typeof t)throw new Error("dispose is not a function");return{[Symbol.iterator]:Pt,next:()=>n?{done:!0}:(n=!0,{done:!1,value:e}),return:()=>(n=!0,t(e),{done:!0}),throw:()=>({done:n=!0})}}function Tt(e){let t,n,r=!1;const i=e((function(e){n?(n(e),n=null):r=!0;return t=e}));if(null!=i&&"function"!=typeof i)throw new Error("function"==typeof i.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Pt,throw:()=>({done:!0}),return:()=>(null!=i&&i(),{done:!0}),next:function(){return{done:!1,value:r?(r=!1,Promise.resolve(t)):new Promise((e=>n=e))}}}}function Lt(e){switch(e.type){case"range":case"number":return e.valueAsNumber;case"date":return e.valueAsDate;case"checkbox":return e.checked;case"file":return e.multiple?e.files:e.files[0];case"select-multiple":return Array.from(e.selectedOptions,(e=>e.value));default:return e.value}}var Mt={disposable:Ot,filter:function*(e,t){for(var n,r=-1;!(n=e.next()).done;)t(n.value,++r)&&(yield n.value)},input:function(e){return Tt((function(t){var n=function(e){switch(e.type){case"button":case"submit":case"checkbox":return"click";case"file":return"change";default:return"input"}}(e),r=Lt(e);function i(){t(Lt(e))}return e.addEventListener(n,i),void 0!==r&&t(r),function(){e.removeEventListener(n,i)}}))},map:function*(e,t){for(var n,r=-1;!(n=e.next()).done;)yield t(n.value,++r)},observe:Tt,queue:function(e){let t;const n=[],r=e((function(e){n.push(e),t&&(t(n.shift()),t=null);return e}));if(null!=r&&"function"!=typeof r)throw new Error("function"==typeof r.then?"async initializers are not supported":"initializer returned something, but not a dispose function");return{[Symbol.iterator]:Pt,throw:()=>({done:!0}),return:()=>(null!=r&&r(),{done:!0}),next:function(){return{done:!1,value:n.length?Promise.resolve(n.shift()):new Promise((e=>t=e))}}}},range:function*(e,t,n){e=+e,t=+t,n=(i=arguments.length)<2?(t=e,e=0,1):i<3?1:+n;for(var r=-1,i=0|Math.max(0,Math.ceil((t-e)/n));++r<i;)yield e+r*n},valueAt:function(e,t){if(!(!isFinite(t=+t)||t<0||t!=t|0))for(var n,r=-1;!(n=e.next()).done;)if(++r===t)return n.value},worker:function(e){const t=URL.createObjectURL(new Blob([e],{type:"text/javascript"})),n=new Worker(t);return Ot(n,(()=>{n.terminate(),URL.revokeObjectURL(t)}))}};function Rt(e,t){return function(n){var r,i,s,o,a,l,c,u,d=n[0],h=[],f=null,p=-1;for(a=1,l=arguments.length;a<l;++a){if((r=arguments[a])instanceof Node)h[++p]=r,d+="\x3c!--o:"+p+"--\x3e";else if(Array.isArray(r)){for(c=0,u=r.length;c<u;++c)(i=r[c])instanceof Node?(null===f&&(h[++p]=f=document.createDocumentFragment(),d+="\x3c!--o:"+p+"--\x3e"),f.appendChild(i)):(f=null,d+=i);f=null}else d+=r;d+=n[a]}if(f=e(d),++p>0){for(s=new Array(p),o=document.createTreeWalker(f,NodeFilter.SHOW_COMMENT,null,!1);o.nextNode();)i=o.currentNode,/^o:/.test(i.nodeValue)&&(s[+i.nodeValue.slice(2)]=i);for(a=0;a<p;++a)(i=s[a])&&i.parentNode.replaceChild(h[a],i)}return 1===f.childNodes.length?f.removeChild(f.firstChild):11===f.nodeType?((i=t()).appendChild(f),i):f}}var Ut=Rt((function(e){var t=document.createElement("template");return t.innerHTML=e.trim(),document.importNode(t.content,!0)}),(function(){return document.createElement("span")}));function qt(e){let t;Object.defineProperties(this,{generator:{value:Tt((e=>{t=e}))},value:{get:()=>e,set:n=>t(e=n)}}),void 0!==e&&t(e)}function*It(){for(;;)yield Date.now()}var Dt=new Map;function Ht(e,t){var n;return(n=Dt.get(e=+e))?n.then((()=>t)):(n=Date.now())>=e?Promise.resolve(t):function(e,t){var n=new Promise((function(n){Dt.delete(t);var r=t-e;if(!(r>0))throw new Error("invalid time");if(r>2147483647)throw new Error("too long to wait");setTimeout(n,r)}));return Dt.set(t,n),n}(n,e).then((()=>t))}var zt={delay:function(e,t){return new Promise((function(n){setTimeout((function(){n(t)}),e)}))},tick:function(e,t){return Ht(Math.ceil((Date.now()+1)/e)*e,t)},when:Ht};function Bt(e,t){if(/^(\w+:)|\/\//i.test(e))return e;if(/^[.]{0,2}\//i.test(e))return new URL(e,t??location).href;if(!e.length||/^[\s._]/.test(e)||/\s$/.test(e))throw new Error("illegal name");return"https://unpkg.com/"+e}var Ft=Rt((function(e){var t=document.createElementNS("http://www.w3.org/2000/svg","g");return t.innerHTML=e.trim(),t}),(function(){return document.createElementNS("http://www.w3.org/2000/svg","g")})),Wt=String.raw;function Vt(e){return new Promise((function(t,n){var r=document.createElement("link");r.rel="stylesheet",r.href=e,r.onerror=n,r.onload=t,document.head.appendChild(r)}))}function Zt(){return Tt((function(e){var t=e(document.body.clientWidth);function n(){var n=document.body.clientWidth;n!==t&&e(t=n)}return window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}}))}const Gt=Object.assign((async(e,t,n)=>{const r=function(e,t){const n=t&&"function"==typeof t.escape?t.escape:e=>e,{select:r,from:i,filter:s,sort:o,slice:a}=e;if(null===i.table||null===r.columns||r.columns&&0===r.columns.length)return;const l=r.columns.map((e=>`t.${n(e)}`)),c=[[`SELECT ${l} FROM ${Kt(i.table,n)} t`]];for(let e=0;e<s.length;++e)Jt(e?"\nAND ":"\nWHERE ",c),Xt(s[e],c);for(let e=0;e<o.length;++e)Jt(e?", ":"\nORDER BY ",c),Qt(o[e],c);null===a.to&&null===a.from||Jt("\nLIMIT "+(null!==a.to?a.to-(a.from||0):1e9),c);null!==a.from&&Jt(` OFFSET ${a.from}`,c);return c}(t,await e);return r?Yt(await e,r,n):null}),{sql:(e,t)=>async function(){return Yt(e,arguments,t)}});async function Yt(e,t,n){if(e){if("function"==typeof e.queryTag){const r=new AbortController,i={signal:r.signal};if(n.then((()=>r.abort("invalidated"))),"function"==typeof e.queryStream)return async function*(e){const t=await e,n=[];n.done=!1,n.error=null,n.schema=t.schema;try{const e=t.readRows();do{const t=await e.next();if(t.done)n.done=!0;else for(const e of t.value)n.push(e);yield n}while(!n.done)}catch(e){n.error=e,yield n}}(e.queryStream(...e.queryTag.apply(e,t),i));if("function"==typeof e.query)return e.query(...e.queryTag.apply(e,t),i)}if("function"==typeof e.sql)return e.sql.apply(e,t);throw new Error("source does not implement query, queryStream, or sql")}}function Kt(e,t){if("object"==typeof e){let n="";return null!=e.database&&(n+=t(e.database)+"."),null!=e.schema&&(n+=t(e.schema)+"."),n+=t(e.table),n}return e}function Jt(e,t){const n=t[0];n[n.length-1]+=e}function Qt({column:e,direction:t},n){Jt(`t.${e} ${t.toUpperCase()}`,n)}function Xt({type:e,operands:t},n){if(t.length<1)throw new Error("Invalid operand length");if(1===t.length)switch(en(t[0],n),e){case"n":return void Jt(" IS NULL",n);case"nn":return void Jt(" IS NOT NULL",n);default:throw new Error("Invalid filter operation")}if(2!==t.length||["in","nin"].includes(e)){var r;switch(en(t[0],n),e){case"in":Jt(" IN (",n);break;case"nin":Jt(" NOT IN (",n);break;default:throw new Error("Invalid filter operation")}!function(e,t){let n=!0;for(const r of e)n?n=!1:Jt(",",t),t.push(r.value),t[0].push("")}(t.slice(1),n),Jt(")",n)}else{if(["c","nc"].includes(e)){switch(en(t[0],n),e){case"c":Jt(" LIKE ",n);break;case"nc":Jt(" NOT LIKE ",n)}return void en((r=t[1],{...r,value:`%${r.value}%`}),n)}switch(en(t[0],n),e){case"eq":Jt(" = ",n);break;case"ne":Jt(" <> ",n);break;case"gt":Jt(" > ",n);break;case"lt":Jt(" < ",n);break;case"gte":Jt(" >= ",n);break;case"lte":Jt(" <= ",n);break;default:throw new Error("Invalid filter operation")}en(t[1],n)}}function en(e,t){"column"===e.type?Jt(`t.${e.value}`,t):(t.push(e.value),t[0].push(""))}var tn=Object.assign(Object.defineProperties((function(e){const t=function(e){return null==e?ot:tt(e)}(e);var n;Object.defineProperties(this,(n={FileAttachment:()=>Et,Mutable:()=>qt,now:It,width:Zt,dot:()=>t(ke.resolve()),htl:()=>t(Ne.resolve()),html:()=>Ut,md:()=>function(e){return e(Oe.resolve()).then((function(t){return Rt((function(n){var r=document.createElement("div");r.innerHTML=t(n,{langPrefix:""}).trim();var i=r.querySelectorAll("pre code[class]");return i.length>0&&e(Se.resolve()).then((function(t){i.forEach((function(n){function r(){t.highlightBlock(n),n.parentNode.classList.add("observablehq--md-pre")}t.getLanguage(n.className)?r():e(Se.resolve("async-languages/index.js")).then((r=>{if(r.has(n.className))return e(Se.resolve("async-languages/"+r.get(n.className))).then((e=>{t.registerLanguage(n.className,e)}))})).then(r,r)}))})),r}),(function(){return document.createElement("div")}))}))}(t),svg:()=>Ft,tex:()=>function(e){return Promise.all([e(je.resolve()),e.resolve(je.resolve("dist/katex.min.css")).then(Vt)]).then((function(e){var t=e[0],n=r();function r(e){return function(){var n=document.createElement("div");return t.render(Wt.apply(String,arguments),n,e),n.removeChild(n.firstChild)}}return n.options=r,n.block=r({displayMode:!0}),n}))}(t),_:()=>t(Ce.resolve()),aq:()=>t.alias({"apache-arrow":Ue.resolve()})(qe.resolve()),Arrow:()=>t(Ue.resolve()),d3:()=>t(xe.resolve()),Inputs:()=>t($e.resolve()).then((e=>({...e,file:e.fileOf(wt)}))),L:()=>async function(e){const t=await e(ze.resolve());if(!t._style){const n=document.createElement("link");n.rel="stylesheet",n.href=await e.resolve(ze.resolve("dist/leaflet.css")),t._style=document.head.appendChild(n)}return t}(t),mermaid:()=>async function(e){const t=await e(He.resolve());return t.initialize({securityLevel:"loose",theme:"neutral"}),function(){const e=document.createElement("div");return e.innerHTML=t.render(St().id,String.raw.apply(String,arguments)),e.removeChild(e.firstChild)}}(t),Plot:()=>t(Ae.resolve()),__query:()=>Gt,require:()=>t,resolve:()=>Bt,SQLite:()=>at(t),SQLiteDatabaseClient:()=>lt,topojson:()=>t(Ie.resolve()),vl:()=>async function(e){const[t,n,r]=await Promise.all([Le,Me,Re].map((t=>e(t.resolve()))));return r.register(t,n)}(t),aapl:()=>new gt("https://static.observableusercontent.com/files/3ccff97fd2d93da734e76829b2b066eafdaac6a1fafdec0faf6ebc443271cfc109d29e80dd217468fcb2aff1e6bffdc73f356cc48feb657f35378e6abbbb63b9").csv({typed:!0}),alphabet:()=>new gt("https://static.observableusercontent.com/files/75d52e6c3130b1cae83cda89305e17b50f33e7420ef205587a135e8562bcfd22e483cf4fa2fb5df6dff66f9c5d19740be1cfaf47406286e2eb6574b49ffc685d").csv({typed:!0}),cars:()=>new gt("https://static.observableusercontent.com/files/048ec3dfd528110c0665dfa363dd28bc516ffb7247231f3ab25005036717f5c4c232a5efc7bb74bc03037155cb72b1abe85a33d86eb9f1a336196030443be4f6").csv({typed:!0}),citywages:()=>new gt("https://static.observableusercontent.com/files/39837ec5121fcc163131dbc2fe8c1a2e0b3423a5d1e96b5ce371e2ac2e20a290d78b71a4fb08b9fa6a0107776e17fb78af313b8ea70f4cc6648fad68ddf06f7a").csv({typed:!0}),diamonds:()=>new gt("https://static.observableusercontent.com/files/87942b1f5d061a21fa4bb8f2162db44e3ef0f7391301f867ab5ba718b225a63091af20675f0bfe7f922db097b217b377135203a7eab34651e21a8d09f4e37252").csv({typed:!0}),flare:()=>new gt("https://static.observableusercontent.com/files/a6b0d94a7f5828fd133765a934f4c9746d2010e2f342d335923991f31b14120de96b5cb4f160d509d8dc627f0107d7f5b5070d2516f01e4c862b5b4867533000").csv({typed:!0}),industries:()=>new gt("https://static.observableusercontent.com/files/76f13741128340cc88798c0a0b7fa5a2df8370f57554000774ab8ee9ae785ffa2903010cad670d4939af3e9c17e5e18e7e05ed2b38b848ac2fc1a0066aa0005f").csv({typed:!0}),miserables:()=>new gt("https://static.observableusercontent.com/files/31d904f6e21d42d4963ece9c8cc4fbd75efcbdc404bf511bc79906f0a1be68b5a01e935f65123670ed04e35ca8cae3c2b943f82bf8db49c5a67c85cbb58db052").json(),olympians:()=>new gt("https://static.observableusercontent.com/files/31ca24545a0603dce099d10ee89ee5ae72d29fa55e8fc7c9ffb5ded87ac83060d80f1d9e21f4ae8eb04c1e8940b7287d179fe8060d887fb1f055f430e210007c").csv({typed:!0}),penguins:()=>new gt("https://static.observableusercontent.com/files/715db1223e067f00500780077febc6cebbdd90c151d3d78317c802732252052ab0e367039872ab9c77d6ef99e5f55a0724b35ddc898a1c99cb14c31a379af80a").csv({typed:!0}),weather:()=>new gt("https://static.observableusercontent.com/files/693a46b22b33db0f042728700e0c73e836fa13d55446df89120682d55339c6db7cc9e574d3d73f24ecc9bc7eb9ac9a1e7e104a1ee52c00aab1e77eb102913c1f").csv({typed:!0}),DOM:Ct,Files:Nt,Generators:Mt,Promises:zt},Object.fromEntries(Object.entries(n).map(nn))))}),{resolve:{get:()=>ot.resolve,enumerable:!0,configurable:!0},require:{get:()=>ot,set:function(e){ot=e},enumerable:!0,configurable:!0}}),{resolveFrom:Xe,requireFrom:tt});function nn([e,t]){return[e,{value:t,writable:!0,enumerable:!0}]}function rn(e,t){this.message=e+"",this.input=t}function sn(e){return function(){return e}}function on(e){return e}rn.prototype=Object.create(Error.prototype),rn.prototype.name="RuntimeError",rn.prototype.constructor=rn;var an=Array.prototype.map;function ln(){}var cn={};function un(e,t,n){var r;n||(n=cn),Object.defineProperties(this,{_observer:{value:n,writable:!0},_definition:{value:fn,writable:!0},_duplicate:{value:void 0,writable:!0},_duplicates:{value:void 0,writable:!0},_indegree:{value:NaN,writable:!0},_inputs:{value:[],writable:!0},_invalidate:{value:ln,writable:!0},_module:{value:t},_name:{value:null,writable:!0},_outputs:{value:new Set,writable:!0},_promise:{value:Promise.resolve(void 0),writable:!0},_reachable:{value:n!==cn,writable:!0},_rejector:{value:(r=this,function(e){if(e===pn)throw e;if(e===fn)throw new rn(r._name+" is not defined",r._name);if(e instanceof Error&&e.message)throw new rn(e.message,r._name);throw new rn(r._name+" could not be resolved",r._name)})},_type:{value:e},_value:{value:void 0,writable:!0},_version:{value:0,writable:!0}})}function dn(e){e._module._runtime._dirty.add(e),e._outputs.add(this)}function hn(e){e._module._runtime._dirty.add(e),e._outputs.delete(this)}function fn(){throw fn}function pn(){throw pn}function mn(e){return function(){throw new rn(e+" is defined more than once")}}function vn(e,t,n){var r=this._module._scope,i=this._module._runtime;if(this._inputs.forEach(hn,this),t.forEach(dn,this),this._inputs=t,this._definition=n,this._value=void 0,n===ln?i._variables.delete(this):i._variables.add(this),e!==this._name||r.get(e)!==this){var s,o;if(this._name)if(this._outputs.size)r.delete(this._name),(o=this._module._resolve(this._name))._outputs=this._outputs,this._outputs=new Set,o._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(this)]=o}),this),o._outputs.forEach(i._updates.add,i._updates),i._dirty.add(o).add(this),r.set(this._name,o);else if((o=r.get(this._name))===this)r.delete(this._name);else{if(3!==o._type)throw new Error;o._duplicates.delete(this),this._duplicate=void 0,1===o._duplicates.size&&(o=o._duplicates.keys().next().value,s=r.get(this._name),o._outputs=s._outputs,s._outputs=new Set,o._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(s)]=o})),o._definition=o._duplicate,o._duplicate=void 0,i._dirty.add(s).add(o),i._updates.add(o),r.set(this._name,o))}if(this._outputs.size)throw new Error;e&&((o=r.get(e))?3===o._type?(this._definition=mn(e),this._duplicate=n,o._duplicates.add(this)):2===o._type?(this._outputs=o._outputs,o._outputs=new Set,this._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(o)]=this}),this),i._dirty.add(o).add(this),r.set(e,this)):(o._duplicate=o._definition,this._duplicate=n,(s=new un(3,this._module))._name=e,s._definition=this._definition=o._definition=mn(e),s._outputs=o._outputs,o._outputs=new Set,s._outputs.forEach((function(e){e._inputs[e._inputs.indexOf(o)]=s})),s._duplicates=new Set([this,o]),i._dirty.add(o).add(s),i._updates.add(o).add(s),r.set(e,s)):r.set(e,this)),this._name=e}return this._version>0&&++this._version,i._updates.add(this),i._compute(),this}function _n(e,t=[]){Object.defineProperties(this,{_runtime:{value:e},_scope:{value:new Map},_builtins:{value:new Map([["@variable",gn],["invalidation",En],["visibility",xn],...t])},_source:{value:null,writable:!0}})}async function yn(e,t){await e._compute();try{return await t._promise}catch(n){if(n===pn)return yn(e,t);throw n}}function bn(e){return e._name}Object.defineProperties(un.prototype,{_pending:{value:function(){this._observer.pending&&this._observer.pending()},writable:!0,configurable:!0},_fulfilled:{value:function(e){this._observer.fulfilled&&this._observer.fulfilled(e,this._name)},writable:!0,configurable:!0},_rejected:{value:function(e){this._observer.rejected&&this._observer.rejected(e,this._name)},writable:!0,configurable:!0},define:{value:function(e,t,n){switch(arguments.length){case 1:n=e,e=t=null;break;case 2:n=t,"string"==typeof e?t=null:(t=e,e=null)}return vn.call(this,null==e?null:e+"",null==t?[]:an.call(t,this._module._resolve,this._module),"function"==typeof n?n:sn(n))},writable:!0,configurable:!0},delete:{value:function(){return vn.call(this,null,[],ln)},writable:!0,configurable:!0},import:{value:function(e,t,n){arguments.length<3&&(n=t,t=e);return vn.call(this,t+"",[n._resolve(e+"")],on)},writable:!0,configurable:!0}}),Object.defineProperties(_n.prototype,{_resolve:{value:function(e){var t,n=this._scope.get(e);if(!n)if(n=new un(2,this),this._builtins.has(e))n.define(e,sn(this._builtins.get(e)));else if(this._runtime._builtin._scope.has(e))n.import(e,this._runtime._builtin);else{try{t=this._runtime._global(e)}catch(t){return n.define(e,function(e){return function(){throw e}}(t))}void 0===t?this._scope.set(n._name=e,n):n.define(e,sn(t))}return n},writable:!0,configurable:!0},redefine:{value:function(e){var t=this._scope.get(e);if(!t)throw new rn(e+" is not defined");if(3===t._type)throw new rn(e+" is defined more than once");return t.define.apply(t,arguments)},writable:!0,configurable:!0},define:{value:function(){var e=new un(1,this);return e.define.apply(e,arguments)},writable:!0,configurable:!0},derive:{value:function(e,t){const n=new Map,r=new Set,i=[];function s(e){let t=n.get(e);return t||(t=new _n(e._runtime,e._builtins),t._source=e,n.set(e,t),i.push([t,e]),r.add(e),t)}const o=s(this);for(const n of e){const{alias:e,name:r}="object"==typeof n?n:{name:n};o.import(r,e??r,t)}for(const e of r)for(const[t,n]of e._scope)if(n._definition===on){if(e===this&&o._scope.has(t))continue;const r=n._inputs[0]._module;r._source&&s(r)}for(const[e,t]of i)for(const[r,i]of t._scope){const t=e._scope.get(r);if(!t||2===t._type)if(i._definition===on){const t=i._inputs[0],s=t._module;e.import(t._name,r,n.get(s)||s)}else e.define(r,i._inputs.map(bn),i._definition)}return o},writable:!0,configurable:!0},import:{value:function(){var e=new un(1,this);return e.import.apply(e,arguments)},writable:!0,configurable:!0},value:{value:async function(e){var t=this._scope.get(e);if(!t)throw new rn(e+" is not defined");if(t._observer!==cn)return yn(this._runtime,t);t=this.variable(!0).define([e],on);try{return await yn(this._runtime,t)}finally{t.delete()}},writable:!0,configurable:!0},variable:{value:function(e){return new un(1,this,e)},writable:!0,configurable:!0},builtin:{value:function(e,t){this._builtins.set(e,t)},writable:!0,configurable:!0}});const wn="function"==typeof requestAnimationFrame?requestAnimationFrame:"function"==typeof setImmediate?setImmediate:e=>setTimeout(e,0);var gn={},En={},xn={};function $n(e=new tn,t=Tn){var n=this.module();if(Object.defineProperties(this,{_dirty:{value:new Set},_updates:{value:new Set},_precomputes:{value:[],writable:!0},_computing:{value:null,writable:!0},_init:{value:null,writable:!0},_modules:{value:new Map},_variables:{value:new Set},_disposed:{value:!1,writable:!0},_builtin:{value:n},_global:{value:t}}),e)for(var r in e)new un(2,n).define(r,[],e[r])}function An(e){const t=new Set(e._inputs);for(const n of t){if(n===e)return!0;n._inputs.forEach(t.add,t)}return!1}function kn(e){++e._indegree}function Sn(e){--e._indegree}function jn(e){return e._promise.catch(e._rejector)}function Cn(e){return new Promise((function(t){e._invalidate=t}))}function Nn(e,t){let n,r,i="function"==typeof IntersectionObserver&&t._observer&&t._observer._node,s=!i,o=ln,a=ln;return i&&(r=new IntersectionObserver((([e])=>(s=e.isIntersecting)&&(n=null,o()))),r.observe(i),e.then((()=>(r.disconnect(),r=null,a())))),function(e){return s?Promise.resolve(e):r?(n||(n=new Promise(((e,t)=>(o=e,a=t)))),n.then((()=>e))):Promise.reject()}}function Pn(e){e._invalidate(),e._invalidate=ln,e._pending();const t=e._value,n=++e._version;let r=null;const i=e._promise=(e._inputs.length?Promise.all(e._inputs.map(jn)).then((function(i){if(e._version!==n)throw pn;for(var s=0,o=i.length;s<o;++s)switch(i[s]){case En:i[s]=r=Cn(e);break;case xn:r||(r=Cn(e)),i[s]=Nn(r,e);break;case gn:i[s]=e}return e._definition.apply(t,i)})):new Promise((n=>n(e._definition.call(t))))).then((function(t){if(e._version!==n)throw pn;if(function(e){return e&&"function"==typeof e.next&&"function"==typeof e.return}(t))return(r||Cn(e)).then((i=t,function(){i.return()})),function(e,t,n){const r=e._module._runtime;let i;function s(e){return new Promise((e=>e(n.next(i)))).then((({done:t,value:n})=>t?void 0:Promise.resolve(n).then(e)))}function o(){const n=s((s=>{if(e._version!==t)throw pn;return i=s,a(s,n).then((()=>r._precompute(o))),e._fulfilled(s),s}));n.catch((r=>{r!==pn&&e._version===t&&(a(void 0,n),e._rejected(r))}))}function a(t,n){return e._value=t,e._promise=n,e._outputs.forEach(r._updates.add,r._updates),r._compute()}return s((n=>{if(e._version!==t)throw pn;return i=n,r._precompute(o),n}))}(e,n,t);var i;return t}));i.then((t=>{e._value=t,e._fulfilled(t)}),(t=>{t!==pn&&(e._value=void 0,e._rejected(t))}))}function On(e,t){e._invalidate(),e._invalidate=ln,e._pending(),++e._version,e._indegree=NaN,(e._promise=Promise.reject(t)).catch(ln),e._value=void 0,e._rejected(t)}function Tn(e){return window[e]}Object.defineProperties($n,{load:{value:function(e,t,n){if("function"==typeof t&&(n=t,t=null),"function"!=typeof n)throw new Error("invalid observer");null==t&&(t=new tn);const{modules:r,id:i}=e,s=new Map,o=new $n(t),a=l(i);function l(e){let t=s.get(e);return t||s.set(e,t=o.module()),t}for(const e of r){const t=l(e.id);let r=0;for(const i of e.variables)i.from?t.import(i.remote,i.name,l(i.from)):t===a?t.variable(n(i,r,e.variables)).define(i.name,i.inputs,i.value):t.define(i.name,i.inputs,i.value),++r}return o},writable:!0,configurable:!0}}),Object.defineProperties($n.prototype,{_precompute:{value:function(e){this._precomputes.push(e),this._compute()},writable:!0,configurable:!0},_compute:{value:function(){return this._computing||(this._computing=this._computeSoon())},writable:!0,configurable:!0},_computeSoon:{value:function(){return new Promise(wn).then((()=>this._disposed?void 0:this._computeNow()))},writable:!0,configurable:!0},_computeNow:{value:async function(){var e,t,n=[],r=this._precomputes;if(r.length){this._precomputes=[];for(const e of r)e();await function(e=0){let t=Promise.resolve();for(let n=0;n<e;++n)t=t.then((()=>{}));return t}(3)}(e=new Set(this._dirty)).forEach((function(t){t._inputs.forEach(e.add,e);const n=function(e){if(e._observer!==cn)return!0;var t=new Set(e._outputs);for(const e of t){if(e._observer!==cn)return!0;e._outputs.forEach(t.add,t)}return!1}(t);n>t._reachable?this._updates.add(t):n<t._reachable&&t._invalidate(),t._reachable=n}),this),(e=new Set(this._updates)).forEach((function(t){t._reachable?(t._indegree=0,t._outputs.forEach(e.add,e)):(t._indegree=NaN,e.delete(t))})),this._computing=null,this._updates.clear(),this._dirty.clear(),e.forEach((function(e){e._outputs.forEach(kn)}));do{for(e.forEach((function(e){0===e._indegree&&n.push(e)}));t=n.pop();)Pn(t),t._outputs.forEach(i),e.delete(t);e.forEach((function(t){An(t)&&(On(t,new rn("circular definition")),t._outputs.forEach(Sn),e.delete(t))}))}while(e.size);function i(e){0==--e._indegree&&n.push(e)}},writable:!0,configurable:!0},dispose:{value:function(){this._computing=Promise.resolve(),this._disposed=!0,this._variables.forEach((e=>{e._invalidate(),e._version=NaN}))},writable:!0,configurable:!0},module:{value:function(e,t=ln){let n;if(void 0===e)return(n=this._init)?(this._init=null,n):new _n(this);if(n=this._modules.get(e),n)return n;this._init=n=new _n(this),this._modules.set(e,n);try{e(this,t)}finally{this._init=null}return n},writable:!0,configurable:!0},fileAttachments:{value:function(e){return Object.assign((t=>{const n=e(t+="");if(null==n)throw new Error(`File not found: ${t}`);if("object"==typeof n&&"url"in n){const{url:e,mimeType:r}=n;return new gt(e,t,r)}return new gt(n,t)}),{prototype:gt.prototype})},writable:!0,configurable:!0}});const Ln=$n.prototype.fileAttachments((function(e){return e}));class Mn{constructor(){const e=Object.assign(new tn,{FileAttachment:()=>Ln});this.runtime=new $n(e),this.main=this.runtime.module()}redefine(e,t,n=[]){this.main.redefine(e,n,t)}variable(e,t,n=[],r){this.main.variable(r).define(e,n,t)}module(e,t){const n=this.runtime.module(e);return t?n.derive(t,this.main):n}import(e,t,n=t){this.main.import(t,n,e)}value(e){return this.main.value(e)}define(e,t){const n=new Map;e.forEach((e=>{if(e.module){const[t,r,i]=e.module;n.set(t,this.module(r,i))}else if(e.import){const[t,r,i]=e.import;this.import(n.get(t),r,i)}else if(e.define){const[n,r,i]=e.define;this.variable(n,i,r,t(e))}}))}handler(e){return async t=>{t.preventDefault();const[n,r]=await this.value(e),i=await Promise.all(r.map((e=>this.value(e)))),s=Object.create(null);i.forEach(((e,t)=>s[r[t]]=e)),await n(s)(t),i.forEach(((e,t)=>{const n=r[t];e!==s[n]&&this.redefine(n,s[n])}))}}}class Rn extends Q{createRenderRoot(){return this}connectedCallback(){this.__initchildnodes||(this.__initchildnodes=!0,this.initialChildNodes(Array.from(this.childNodes)),function(e,t=0){const n=e.childNodes;let r=n.length;for(;r>t;)e.removeChild(n[--r])}(this)),super.connectedCallback()}initialChildNodes(e){this.__children=e}}function Un(e){return T`<span class="error-block">${e}</span>`}const qn=Symbol("dependencies"),In=Symbol("load"),Dn=Promise.resolve(!0),Hn=new Map;function zn(e){let t="undefined"!=typeof HTMLElement&&e instanceof HTMLElement?e.constructor:e;for(;t&&!Object.hasOwn(t,"dependencies");)if(t=Object.getPrototypeOf(t),t&&"HTMLElement"===t.name)return null;return t}function Bn(e){const t=zn(e);if(!t)return Dn;const n=t[qn]||(t[qn]={});if(n[In])return n[In];const r={main:[],css:[]},i=t.dependencies;return i.forEach((({name:t,version:n,main:i,css:s})=>{const o=function(e,t){return n=>`https://cdn.jsdelivr.net/npm/${e}@${t}/${n}`}(t,n),a=o(i),l=o(s),c=Hn.get(a)||et(a);Hn.set(a,c),r.main.push(c),s&&!Hn.has(l)&&(Hn.set(l,!0),r.css.push(function(e,t=globalThis.document){return new Promise((function(n,r){const i=t.createElement("link");i.rel="stylesheet",i.href=e,i.onerror=r,i.onload=n,t.head.appendChild(i)}))}(l,e.ownerDocument)))})),n[In]=Promise.all(r.main.concat(r.css)).then((e=>{const n=i.reduce(((t,n,r)=>(t[n.name]=e[r],t)),{});!function(e,t){const n=zn(e);if(n){const e=n[qn]||(n[qn]={});for(const n in t)e[n]=t[n];e[In]=Dn}}(t,n)}))}class Fn extends Rn{getDependency(e){return function(e,t){return zn(e)?.[qn]?.[t]}(this,e)}shouldUpdate(){return!!function(e){const t=zn(e);return!t||t[qn]?.[In]===Dn}(this)||(Bn(this).then((()=>{this.requestUpdate()})),!1)}}const Wn=[[1,0],[2,0],[3,0],[3,2],[4,0],[5,0],[6,0],[7,0],[8,0],[9,0],[11,10],[11,3],[11,2],[11,0],[12,11],[13,11],[14,11],[15,11],[17,16],[18,16],[18,17],[19,16],[19,17],[19,18],[20,16],[20,17],[20,18],[20,19],[21,16],[21,17],[21,18],[21,19],[21,20],[22,16],[22,17],[22,18],[22,19],[22,20],[22,21],[23,16],[23,17],[23,18],[23,19],[23,20],[23,21],[23,22],[23,12],[23,11],[24,23],[24,11],[25,24],[25,23],[25,11],[26,24],[26,11],[26,16],[26,25],[27,11],[27,23],[27,25],[27,24],[27,26],[28,11],[28,27],[29,23],[29,27],[29,11],[30,23],[31,30],[31,11],[31,23],[31,27],[32,11],[33,11],[33,27],[34,11],[34,29],[35,11],[35,34],[35,29],[36,34],[36,35],[36,11],[36,29],[37,34],[37,35],[37,36],[37,11],[37,29],[38,34],[38,35],[38,36],[38,37],[38,11],[38,29],[39,25],[40,25],[41,24],[41,25],[42,41],[42,25],[42,24],[43,11],[43,26],[43,27],[44,28],[44,11],[45,28],[47,46],[48,47],[48,25],[48,27],[48,11],[49,26],[49,11],[50,49],[50,24],[51,49],[51,26],[51,11],[52,51],[52,39],[53,51],[54,51],[54,49],[54,26],[55,51],[55,49],[55,39],[55,54],[55,26],[55,11],[55,16],[55,25],[55,41],[55,48],[56,49],[56,55],[57,55],[57,41],[57,48],[58,55],[58,48],[58,27],[58,57],[58,11],[59,58],[59,55],[59,48],[59,57],[60,48],[60,58],[60,59],[61,48],[61,58],[61,60],[61,59],[61,57],[61,55],[62,55],[62,58],[62,59],[62,48],[62,57],[62,41],[62,61],[62,60],[63,59],[63,48],[63,62],[63,57],[63,58],[63,61],[63,60],[63,55],[64,55],[64,62],[64,48],[64,63],[64,58],[64,61],[64,60],[64,59],[64,57],[64,11],[65,63],[65,64],[65,48],[65,62],[65,58],[65,61],[65,60],[65,59],[65,57],[65,55],[66,64],[66,58],[66,59],[66,62],[66,65],[66,48],[66,63],[66,61],[66,60],[67,57],[68,25],[68,11],[68,24],[68,27],[68,48],[68,41],[69,25],[69,68],[69,11],[69,24],[69,27],[69,48],[69,41],[70,25],[70,69],[70,68],[70,11],[70,24],[70,27],[70,41],[70,58],[71,27],[71,69],[71,68],[71,70],[71,11],[71,48],[71,41],[71,25],[72,26],[72,27],[72,11],[73,48],[74,48],[74,73],[75,69],[75,68],[75,25],[75,48],[75,41],[75,70],[75,71],[76,64],[76,65],[76,66],[76,63],[76,62],[76,48],[76,58]];function Vn(){return{nodes:Array.from({length:77}).map((e=>({index:e}))),links:Wn.map((e=>({source:e[0],target:e[1]})))}}function Zn(e){return{x:e[0],y:e[1]}}function Gn(e,t,n){const r="#d5aaaa",i="firebrick",s=Vn(),{nodes:o,links:a}=s,l=e.select(t).attr("class","quadtree").append("svg").attr("width",n.width).attr("height",n.height).attr("viewBox","0 0 514 514"),c=l.append("g"),u=c.append("g"),d=c.append("g"),h=c.append("g"),f=c.append("g"),p=c.append("g"),m=c.append("g"),v=n.radius||4,_=[[1,1],[513,513]],y={x:321,y:321},b=e.forceManyBody(),w=e.forceLink(),g=e.forceCenter().x(257).y(257),E=e.forceSimulation().force("link",w).force("charge",b).force("center",g);let x,$,A,k=Math.sqrt(n.theta)||0,S=null,j=0,C=!0,N=!1,P=y,O=!1;function T(){return x=u.selectAll("line").data(a).enter().append("line").style("stroke","#ccc").style("stroke-width",1).style("stroke-opacity",1).style("pointer-events","none"),$=p.selectAll("circle").data(o).enter().append("circle").attr("cx",(e=>e.x)).attr("cy",(e=>e.y)).attr("r",v).style("fill","#666").style("fill-opacity",1).style("cursor","pointer"),E.nodes(o).on("tick",R),E.force("link").links(a),L(),j=0,d.selectAll("rect").style("opacity",0),$.style("fill-opacity",1),l.on("mousemove",D).on("mousedown",z),$.call(e.drag().on("start",U).on("drag",q).on("end",I)),A}function L(){j!=o.length&&M(o),S.visitAfter(B),V().clear(),$.style("fill-opacity",.25)}function M(t){S=e.quadtree().extent(_).x((e=>e.x)).y((e=>e.y)),t&&S.addAll(t),j=t?t.length:0}function R(){j>0&&(M(o),V()),x.attr("x1",(e=>e.source.x)).attr("y1",(e=>e.source.y)).attr("x2",(e=>e.target.x)).attr("y2",(e=>e.target.y)),$.attr("cx",(e=>e.x)).attr("cy",(e=>e.y))}function U(t){C&&(e.event.active||E.alphaTarget(.3).restart(),t.fx=t.x,t.fy=t.y)}function q(t){C&&(t.fx=e.event.x,t.fy=e.event.y)}function I(t){C&&(e.event.active||E.alphaTarget(0),t.fx=null,t.fy=null)}function D(){N&&O&&G(Zn(e.mouse(this)))}function H(){O=!1,window.removeEventListener("mouseup",H)}function z(){if(!N)return;O=!0,window.addEventListener("mouseup",H);let t=e.event.target;G(t&&"circle"==t.localName?t.__data__:Zn(e.mouse(this)))}function B(e,t,n,r,i){let s,o,a,l,c,u=0;if(e.length){let d=[t,n,r,i].join(",");for(a=l=c=0;c<4;++c)(s=e[c])&&(o=s.value)&&(u+=o,a+=o*s.x,l+=o*s.y,s.parent=e,s.pid=d);e.x=a/u,e.y=l/u,e.x1=t,e.y1=n,e.w=r-t,e.h=i-n}else{s=e,s.x=s.data.x,s.y=s.data.y;do{u+=1}while(s=s.next)}e.value=u}function F(e){let t=[];return S.visit((function(n,r,i,s,o){if(e.x<r||e.x>=s||e.y<i||e.y>=o)return!0;t.push({x1:r,y1:i,w:s-r,h:o-i})})),t}function W(){return h.html(""),f.html(""),m.html(""),$.style("fill-opacity",1),A}function V(){let e=[];function t(n,r,i){Array.isArray(n)&&function(n,r,i){let s=r[0],o=r[1],a=[s[0]+o[0]>>1,s[1]+o[1]>>1],l=[[s,a],[[a[0],s[1]],[o[0],a[1]]],[[s[0],a[1]],[a[0],o[1]]],[a,o]];for(let r=0;r<4;++r)e.push(l[r]),l[r].depth=i,n[r]&&t(n[r],l[r],i+1)}(n,r,i)}return S.root()&&(e.push(S.extent().slice()),t(S.root(),S.extent(),1)),d.html("").selectAll("rect").data(e).enter().append("rect").attr("x",(e=>e[0][0]+.5)).attr("y",(e=>e[0][1]+.5)).attr("width",(e=>e[1][0]-e[0][0])).attr("height",(e=>e[1][1]-e[0][1])).style("fill","none").style("stroke","#ddd").style("line-width",.5),A}function Z(){W();let e=P;if(!e)return;let t=[],n=[],s=0,o=0;return S.visit(((r,i,a,l,c)=>{if(!r.value)return!0;let u=r.x-e.x,d=r.y-e.y,h=l-i,f=u*u+d*d;if(r.length&&h*h/k<f){const e={x:r.x,y:r.y,v:r.value,s:5e3*r.value/f};return t.push(e),n.push({x:i,y:a,w:h,h:c-a}),s+=u*r.value/f,o+=d*r.value/f,!0}if(!r.length&&f)do{r.data!==e&&(t.push({x:r.data.x,y:r.data.y,v:1,s:5e3/f}),s+=u/f,o+=d/f)}while(r=r.next)})),h.selectAll("rect").data(n).enter().append("rect").attr("x",(e=>e.x)).attr("y",(e=>e.y)).attr("width",(e=>e.w)).attr("height",(e=>e.h)).style("pointer-events","none").style("fill","none").style("stroke",r).style("stroke-width",2),f.selectAll("path").data(t).enter().append("path").style("pointer-events","none").style("stroke","#991151").style("stroke-opacity",.3).style("stroke-dasharray",[5,5]).style("stroke-linecap","round").style("stroke-width",(e=>Math.max(1,Math.min(5,e.s||1)))).attr("d",(t=>"M"+t.x+","+t.y+"L"+e.x+","+e.y)),m.selectAll("circle").data(t).enter().append("circle").attr("cx",(e=>e.x)).attr("cy",(e=>e.y)).attr("r",(e=>v*(Math.sqrt(e.v)||1))).style("pointer-events","none").style("fill",i),$.style("fill-opacity",.25),m.append("circle").attr("cx",e.x).attr("cy",e.y).attr("r",v).style("pointer-events","none").style("fill","white").style("stroke-width",1.5).style("stroke-linecap","round").style("stroke","#800080"),s=e.x-90*s,o=e.y-90*o,m.append("path").attr("d","M"+e.x+","+e.y+"L"+s+","+o).style("pointer-events","none").style("fill","none").style("stroke-width",1.5).style("stroke-linecap","round").style("stroke","purple"),A}function G(e){return P=e,Z()}return A={svg:l,quad:S,init:T,size:function(t){let n=500;if(M(),t<1)return j=0,V(),h.html(""),m.html(""),void $.style("fill-opacity",.25);j=t;let s=o[--t];S.addAll(o.slice(0,t));let a=F(s);S.add(s).visitAfter(B);let l=F(s).slice(a.length);l.length&&h.html("").selectAll("rect.foo").data(l).enter().append("rect").attr("x",(e=>e.x1)).attr("y",(e=>e.y1)).attr("width",(e=>e.w)).attr("height",(e=>e.h)).style("pointer-events","none").style("fill","none").style("stroke",r).style("stroke-width",2).style("stroke-opacity",1).transition().delay(250).duration(n).style("stroke-opacity",0).remove(),V(),$.style("fill-opacity",(e=>e.index<=t?1:.25)),m.html("").append("circle").datum(s).attr("cx",(e=>e.x)).attr("cy",(e=>e.y)).attr("r",0).style("pointer-events","none").style("fill",i).style("fill-opacity",1).transition().duration(n).ease(e.easeBackOut.overshoot(2)).attr("r",(e=>v)).transition().delay(n).duration(n).style("fill-opacity",0).remove()},clear:W,theta:function(e){return k=e*e,Z()},charge:function(e){const t=+e;t==t&&b.strength(t),C&&E.alpha(.5).alphaTarget(0).restart()},layout:function(e){C!==e&&(C=e,C?E.alpha(.5).alphaTarget(0).restart():E.stop(),$.transition(500).style("fill-opacity",C?1:.25),x.transition(500).style("stroke-opacity",+C))},estimate:function(e){N!==e&&(N=e,N?(L(),G(P)):(P=y,V().clear()))},accumulate:function(t){if(!t)return;let n=400,s=[],o=[],a={};L(),S.visitAfter((function(e){e.length&&s.push(e)})),s.forEach((function(e){const t=e.w;let n=a[t];n||o.push(a[t]=n=[]),n.push(e)})),o.sort(((e,t)=>e[0].w-t[0].w)),setTimeout((()=>{o.forEach((function(t,s){setTimeout((()=>function(t){if(t<1)return void m.html("");o[t-=1].forEach((function(t){const s=t.filter((e=>e));h.append("rect").datum(t).attr("x",(e=>e.x1)).attr("y",(e=>e.y1)).attr("width",(e=>e.w)).attr("height",(e=>e.h)).style("pointer-events","none").style("fill","none").style("stroke",r).style("stroke-width",2).style("stroke-opacity",1).transition().duration(800).delay(1200).style("stroke-opacity",0).remove(),m.selectAll("circle.foo").data(s).enter().append("circle").attr("cx",(e=>e.x)).attr("cy",(e=>e.y)).attr("r",(e=>v*(Math.sqrt(e.value)||1))).style("pointer-events","none").style("fill",i).transition().delay(n).duration(n).ease(e.easeCubicIn).attr("cx",t.x).attr("cy",t.y).remove(),m.append("circle").datum(t).attr("cx",(e=>e.x)).attr("cy",(e=>e.y)).attr("r",0).style("pointer-events","none").style("fill",i).transition().delay(720).duration(n).ease(e.easeBackOut).attr("r",(e=>v*(Math.sqrt(e.value)||1))).transition().delay(n).duration(n).style("fill","#666").style("fill-opacity",.25)}))}(s+1)),1520*s)})),setTimeout((()=>{m.selectAll("circle").transition().duration(500).style("fill-opacity",0).remove()}),1520*(1+o.length))}),1e3)}},T()}var Yn=[{nodes:500,theta:0,time:.56,error:0},{nodes:500,theta:.5,time:3.72,error:.05200202597209933},{nodes:500,theta:1,time:1.62,error:.05235635117626017},{nodes:500,theta:1.5,time:.9,error:.05364959811502322},{nodes:1e3,theta:0,time:1.54,error:0},{nodes:1e3,theta:.5,time:6.42,error:.051100704681022374},{nodes:1e3,theta:1,time:2.68,error:.05145824401863238},{nodes:1e3,theta:1.5,time:1.58,error:.0527730904049427},{nodes:1500,theta:0,time:3.66,error:0},{nodes:1500,theta:.5,time:11.3,error:.05065250167285926},{nodes:1500,theta:1,time:4.36,error:.05100210193824075},{nodes:1500,theta:1.5,time:2.64,error:.052263724165450914},{nodes:2e3,theta:0,time:6.32,error:0},{nodes:2e3,theta:.5,time:16.84,error:.05040655452845216},{nodes:2e3,theta:1,time:6.32,error:.050773438684784816},{nodes:2e3,theta:1.5,time:3.76,error:.05208289581090376},{nodes:2500,theta:0,time:10,error:0},{nodes:2500,theta:.5,time:22.48,error:.05018702377740935},{nodes:2500,theta:1,time:8.04,error:.05054754976730526},{nodes:2500,theta:1.5,time:5.02,error:.05183226903289724},{nodes:3e3,theta:0,time:14.74,error:0},{nodes:3e3,theta:.5,time:27.68,error:.050308818616019844},{nodes:3e3,theta:1,time:10.06,error:.05067487078391384},{nodes:3e3,theta:1.5,time:6.22,error:.05199211876791672},{nodes:3500,theta:0,time:20.64,error:0},{nodes:3500,theta:.5,time:33.62,error:.05004853487486027},{nodes:3500,theta:1,time:12.2,error:.05041703116269491},{nodes:3500,theta:1.5,time:7.7,error:.05170552704388485},{nodes:4e3,theta:0,time:27.32,error:0},{nodes:4e3,theta:.5,time:38.88,error:.05019060517654669},{nodes:4e3,theta:1,time:14.58,error:.05056004954031823},{nodes:4e3,theta:1.5,time:8.9,error:.051869004205317155},{nodes:4500,theta:0,time:34.54,error:0},{nodes:4500,theta:.5,time:44.4,error:.050120388342931955},{nodes:4500,theta:1,time:16.88,error:.0504893948312208},{nodes:4500,theta:1.5,time:10.38,error:.05178804015573142},{nodes:5e3,theta:0,time:43.5,error:0},{nodes:5e3,theta:.5,time:49.82,error:.0502078881851173},{nodes:5e3,theta:1,time:19.42,error:.050556513572848315},{nodes:5e3,theta:1.5,time:12.36,error:.05182141623831191},{nodes:5500,theta:0,time:52.86,error:0},{nodes:5500,theta:.5,time:56.04,error:.05000671534740984},{nodes:5500,theta:1,time:21.84,error:.05036747490974292},{nodes:5500,theta:1.5,time:13.16,error:.051636964809069846},{nodes:6e3,theta:0,time:63.12,error:0},{nodes:6e3,theta:.5,time:62.34,error:.050108840001680185},{nodes:6e3,theta:1,time:25.44,error:.0504845789284521},{nodes:6e3,theta:1.5,time:15.1,error:.05178990719815004},{nodes:6500,theta:0,time:74.02,error:0},{nodes:6500,theta:.5,time:68.32,error:.05015978570893315},{nodes:6500,theta:1,time:27.22,error:.050524547776730995},{nodes:6500,theta:1.5,time:16.58,error:.051807786978559624},{nodes:7e3,theta:0,time:86.86,error:0},{nodes:7e3,theta:.5,time:75.84,error:.05009715454588301},{nodes:7e3,theta:1,time:28.96,error:.050464252838042886},{nodes:7e3,theta:1.5,time:18.34,error:.05175272301004472},{nodes:7500,theta:0,time:97.92,error:0},{nodes:7500,theta:.5,time:80.12,error:.050103625186719125},{nodes:7500,theta:1,time:31.7,error:.05046902952584346},{nodes:7500,theta:1.5,time:20.72,error:.051759162426569125},{nodes:8e3,theta:0,time:114.32,error:0},{nodes:8e3,theta:.5,time:88.52,error:.05010771874184223},{nodes:8e3,theta:1,time:34.52,error:.05046208406423784},{nodes:8e3,theta:1.5,time:22.96,error:.051739305168694634},{nodes:8500,theta:0,time:129.82,error:0},{nodes:8500,theta:.5,time:97.96,error:.04991075721026138},{nodes:8500,theta:1,time:35.4,error:.050271992053986664},{nodes:8500,theta:1.5,time:24.1,error:.051558114104811856},{nodes:9e3,theta:0,time:148.58,error:0},{nodes:9e3,theta:.5,time:105.14,error:.049955850454765756},{nodes:9e3,theta:1,time:38.02,error:.050320401669984936},{nodes:9e3,theta:1.5,time:25.9,error:.051606533672847184},{nodes:9500,theta:0,time:163.66,error:0},{nodes:9500,theta:.5,time:110.06,error:.050049450254373},{nodes:9500,theta:1,time:40.44,error:.05040925481053241},{nodes:9500,theta:1.5,time:27.48,error:.0516827503789717},{nodes:1e4,theta:0,time:181.56,error:0},{nodes:1e4,theta:.5,time:112.24,error:.050078126512543175},{nodes:1e4,theta:1,time:43.94,error:.05043578694613407},{nodes:1e4,theta:1.5,time:30.7,error:.05171306545026989}];class Kn extends Fn{static get dependencies(){return[{name:"vega",version:"5",main:"build/vega.min.js"}]}static get properties(){return{value:{type:Number}}}constructor(e){super(),this._spec=e,this.value=1}render(){const e=this.getDependency("vega");if(e)return this._root||(this._root=document.createElement("div"),this._root.style["margin-left"]="-35px",this._root.style.padding="1em 0",this._view=new e.View(e.parse(this._spec)).renderer("svg").logLevel(e.Warn).initialize(this._root).insert("perf",Yn),this._view.addSignalListener("theta",((e,t)=>{t!=this.value&&(this.value=t,this.dispatchEvent(new Event("input")))}))),this._view.signal("theta",this.value).run(),this._root}}const Jn={width:635,height:200,autosize:"fit",config:{title:{fontSize:12,frame:"group",anchor:"start",offset:0}},signals:[{name:"theta",value:-1,on:[{events:"text:mouseover, line:mouseover",update:"datum.theta"},{events:"text:mouseout, line:mouseout",update:"-abs(theta) - 1"}]},{name:"foci",value:[0,.5,1,1.5]}],data:[{name:"perf",transform:[{type:"filter",expr:"datum.theta > 0"}]},{name:"labels",source:"perf",transform:[{type:"filter",expr:"datum.nodes === 1e4"},{type:"formula",as:"label",expr:'datum.theta ? "ϴ = " + datum.theta : "Naïve"'}]}],scales:[{name:"xs",type:"linear",domain:{data:"perf",field:"nodes"},range:"width"},{name:"ys",type:"linear",domain:{data:"perf",field:"error"},range:"height",zero:!1,nice:!0},{name:"cs",type:"ordinal",range:["rgb(140, 41, 129)","rgb(222, 73, 104)","rgb(254, 159, 109)"]}],title:"Average Error, Relative to Naïve Calculation (pixels)",axes:[{orient:"left",scale:"ys",grid:!0,tickCount:5,minExtent:35},{orient:"bottom",scale:"xs",title:"Number of Points"}],marks:[{type:"group",from:{facet:{data:"perf",name:"series",groupby:"theta"}},marks:[{type:"line",from:{data:"series"},encode:{enter:{interpolate:"monotone",x:{scale:"xs",field:"nodes"},y:{scale:"ys",field:"error"},stroke:{scale:"cs",field:"theta"},strokeWidth:{value:3}},update:{opacity:{signal:"indexof(foci, theta) < 0 || theta === datum.theta ? 1 : 0.25"}}}}]},{type:"text",from:{data:"labels"},encode:{enter:{x:{scale:"xs",field:"nodes"},dx:{value:6},y:{scale:"ys",field:"error"},baseline:{value:"middle"},text:{field:"label"},fill:{scale:"cs",field:"theta"}},update:{opacity:{signal:"indexof(foci, theta) < 0 || theta === datum.theta ? 1 : 0.25"}}}}]};const Qn={width:635,height:200,autosize:"fit",config:{title:{fontSize:12,frame:"group",anchor:"start",offset:0}},signals:[{name:"theta",value:-1,on:[{events:"text:mouseover, line:mouseover",update:"datum.theta"},{events:"text:mouseout, line:mouseout",update:"-abs(theta) - 1"}]},{name:"foci",value:[0,.5,1,1.5]}],data:[{name:"perf"},{name:"labels",source:"perf",transform:[{type:"filter",expr:"datum.nodes === 1e4"},{type:"formula",as:"label",expr:'datum.theta ? "ϴ = " + datum.theta : "Naïve"'}]}],scales:[{name:"xs",type:"linear",domain:{data:"perf",field:"nodes"},range:"width"},{name:"ys",type:"linear",domain:{data:"perf",field:"time"},range:"height",nice:!0},{name:"cs",type:"ordinal",domain:{data:"perf",field:"theta",sort:!0},range:["rgb(59, 15, 112)","rgb(140, 41, 129)","rgb(222, 73, 104)","rgb(254, 159, 109)"]}],title:"Average Running Time (milliseconds)",axes:[{orient:"left",scale:"ys",grid:!0,tickCount:5,minExtent:35},{orient:"bottom",scale:"xs",title:"Number of Points"}],marks:[{type:"group",from:{facet:{data:"perf",name:"series",groupby:"theta"}},marks:[{type:"line",from:{data:"series"},encode:{enter:{interpolate:"monotone",x:{scale:"xs",field:"nodes"},y:{scale:"ys",field:"time"},stroke:{scale:"cs",field:"theta"},strokeWidth:{value:3}},update:{opacity:{signal:"indexof(foci, theta) < 0 || theta === datum.theta ? 1 : 0.25"}}}}]},{type:"text",from:{data:"labels"},encode:{enter:{x:{scale:"xs",field:"nodes"},dx:{value:6},y:{scale:"ys",field:"time"},baseline:{value:"middle"},text:{field:"label"},fill:{scale:"cs",field:"theta"}},update:{opacity:{signal:"indexof(foci, theta) < 0 || theta === datum.theta ? 1 : 0.25"}}}}]};var Xn=Object.freeze({__proto__:null,cells:function(){return[{define:["charge",[],function(){return-30}],cell:0},{define:["step",[],function(){return 0}],cell:1},{define:["accum",[],function(){return 0}],cell:2},{define:["theta",[],function(){return 0}],cell:3},{define:["focus",[],function(){return-1}],cell:4},{define:["layout",[],function(){return!0}],cell:5},{define:["estimate",[],function(){return!1}],cell:6},{define:[null,["Inputs"],function(e){return e.range([-30,10],{step:1,label:"Force Strength"})}],cell:7},{define:[null,["Inputs"],function(e){return e.range([0,77],{step:1,label:"Inserted Points"})}],cell:8},{define:[null,["Inputs","focus"],function(e,t){return e.range([0,2],{step:.1,label:"Theta Θ",value:t<0?-(t+1):t})}],cell:9}]},attrs:function(){return[{define:[null,["step"],function(e){return e}],cell:0},{define:[null,["theta"],function(e){return e}],cell:1},{define:[null,["charge"],function(e){return e}],cell:2},{define:[null,["layout","estimate"],function(e,t){return e&&!t}],cell:3},{define:[null,["estimate"],function(e){return e}],cell:4},{define:[null,["accum"],function(e){return e}],cell:5}]},event:function(){return[{define:["__event0__",["alert"],function(e){return[t=>t=>{e("👍 🎉")},[]]}],cell:0},{define:["__event1__",[],function(){return[e=>t=>{e.layout=!1,e.step=0},["layout","step"]]}],cell:1},{define:["__event2__",[],function(){return[e=>t=>{e.layout=!1,e.step=1},["layout","step"]]}],cell:2},{define:["__event3__",[],function(){return[e=>t=>{e.layout=!1,e.step=2},["layout","step"]]}],cell:3},{define:["__event4__",[],function(){return[e=>t=>{e.layout=!1,e.step=Math.min(e.step+1,77)},["layout","step"]]}],cell:4},{define:["__event5__",[],function(){return[e=>t=>{e.layout=!1,e.step=Math.min(e.step+1,77)},["layout","step"]]}],cell:5},{define:["__event6__",[],function(){return[e=>t=>{e.layout=!1,e.step=Math.min(e.step+1,77)},["layout","step"]]}],cell:6},{define:["__event7__",[],function(){return[e=>t=>{e.layout=!1,++e.accum},["layout","accum"]]}],cell:7},{define:["__event8__",[],function(){return[e=>t=>{e.theta=0,e.estimate=!0},["theta","estimate"]]}],cell:8},{define:["__event9__",[],function(){return[e=>t=>{e.theta=1,e.estimate=!0},["theta","estimate"]]}],cell:9},{define:["__event10__",[],function(){return[e=>t=>{e.focus=0},["focus"]]}],cell:10},{define:["__event11__",[],function(){return[e=>t=>{e.focus=.5},["focus"]]}],cell:11},{define:["__event12__",[],function(){return[e=>t=>{e.focus=1},["focus"]]}],cell:12},{define:["__event13__",[],function(){return[e=>t=>{e.focus=1.5},["focus"]]}],cell:13},{define:["__event14__",[],function(){return[e=>t=>{e.focus=1},["focus"]]}],cell:14},{define:["__event15__",[],function(){return[e=>t=>{e.focus=1.5},["focus"]]}],cell:15},{define:["__event16__",[],function(){return[e=>t=>{e.focus=1.5},["focus"]]}],cell:16},{define:["__event17__",[],function(){return[e=>t=>{e.focus=1},["focus"]]}],cell:17},{define:["__event18__",[],function(){return[e=>t=>{e.focus=.5},["focus"]]}],cell:18},{define:["__event19__",[],function(){return[e=>t=>{e.step=77,e.estimate=!1,e.layout=!0},["step","estimate","layout"]]}],cell:19}]}});window.customElements.define("cell-view",class extends Rn{static get properties(){return{value:{state:!0},status:{type:String,state:!0}}}constructor(){super(),this.status="pending",this.observer=new re(((e,t)=>{this.status=e,"pending"!==e&&(this.value=t,this.dispatchEvent(new Event("change")))}))}render(){switch(this.status){case"pending":case"fulfilled":return this.value;case"rejected":return Un(this.value.error);default:return Un(`Unrecognized status: ${this.status}.`)}}}),window.customElements.define("barnes-hut",class extends Fn{static get dependencies(){return[{name:"d3",version:"4",main:"build/d3.min.js"}]}static get properties(){return{width:{type:Number},height:{type:Number},size:{type:Number},theta:{type:Number},charge:{type:Number},radius:{type:Number},accumulate:{type:Number},layout:{type:Boolean,converter:e=>"false"!==e},estimate:{type:Boolean,converter:e=>"false"!==e}}}constructor(){super(),this.width=514,this.height=514,this.size=0,this.theta=0,this.charge=-30,this.radius=4,this.accumulate=!1,this.layout=!0,this.estimate=!1}willUpdate(e){this._sim&&e.forEach(((e,t)=>{this._sim[t](this[t])}))}render(){const e=this.getDependency("d3");if(e)return this._root||(this._root=document.createElement("div"),this._root.setAttribute("class","quad"),this._sim=Gn(e,this._root,{width:this.width,height:this.height,theta:this.theta,radius:this.radius})),this._root}}),window.customElements.define("error-plot",class extends Kn{constructor(){super(Jn)}}),window.customElements.define("time-plot",class extends Kn{constructor(){super(Qn)}}),window.addEventListener("DOMContentLoaded",(()=>{const e=document.querySelector("article");ie(new Mn,e,Xn,{_id:21,attrs:[["1","size",0],["1","theta",1],["1","charge",2],["1","layout",3],["1","estimate",4],["1","accumulate",5]],events:[["2","click",0],["3","click",1],["4","click",2],["5","click",3],["6","click",4],["7","click",5],["8","click",6],["9","click",7],["10","click",8],["11","click",9],["12","click",10],["13","click",11],["14","click",12],["15","click",13],["16","click",14],["17","click",15],["18","click",16],["19","click",17],["20","click",18],["21","click",19]]})}));

    </script>